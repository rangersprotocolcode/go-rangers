// Copyright 2020 The RocketProtocol Authors
// This file is part of the RocketProtocol library.
//
// The RocketProtocol library is free software: you can redistribute it and/or modify
// it under the terms of the GNU Lesser General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// The RocketProtocol library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU Lesser General Public License for more details.
//
// You should have received a copy of the GNU Lesser General Public License
// along with the RocketProtocol library. If not, see <http://www.gnu.org/licenses/>.

package core

import (
	"com.tuntun.rocket/node/src/common"
	"com.tuntun.rocket/node/src/middleware/types"
	"com.tuntun.rocket/node/src/utility"
	"encoding/json"
	"fmt"
	"testing"
)

var privateKey string = ""

func TestProposerApplyTx(t *testing.T) {
	source := ""
	privateKeyStr := ""
	tx := types.Transaction{Type: 2, Source: source, Time: utility.GetTime().String(), ChainId: "9500"}

	data := `{"id":"0x6426f4123f7f5202055c68d6c6e73d7a74bad1487adac79690a53619c8f1e084","publicKey":"0x7a14822562e7878cbaa0ea91f4e7732d9d85502a2acf7723940c681af397c11009d450c463b8c5081e9cf7322fe1ccca062f86c2c81b7f19ce3b99771f13b2fb7c160c21c4dfbf44752b89502cd574972819d812d307e6bf64d67e0f84ce7af5072145272d28fb1df4cc86c14c88dac161e3827e47572623105c6a3f91def95c","vrfPublicKey":"dtZTu7NccUEq3jdhp1/O6ZX5X0M/D60rEFLor1bmbOQ=","ApplyHeight":0,"Status":0}`
	var obj = types.Miner{}
	err := json.Unmarshal([]byte(data), &obj)
	if err != nil {
		fmt.Printf("ummarshal error:%v", err)
	}

	obj.Stake = 2000
	obj.Type = common.MinerTypeProposer

	applyData, _ := json.Marshal(obj)
	//fmt.Printf("data:%v\n",string(applyData))

	tx.Data = string(applyData)
	tx.Hash = tx.GenHash()

	privateKey := common.HexStringToSecKey(privateKeyStr)
	sign := privateKey.Sign(tx.Hash.Bytes())
	tx.Sign = &sign

	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestVerifierApplyTx(t *testing.T) {
	source := ""
	privateKeyStr := ""
	tx := types.Transaction{Type: 2, Source: source, Time: utility.GetTime().String(), ChainId: "9500"}

	data := `{"id":"0x289ecde8a89bb2af023fa699f93147dd2f42dddd8418d0dd54d1d2c0969ae552","publicKey":"0x352efbbcf50c0ee8509a018fd0c81d1e79072364b8df92bf082ab54acf3f449585859e555566c08917622c5843d20a16fb753d6db1aa9321619ee5cd85762a19411fd9f910397cb5d816bcd0d18fb60ae774cd178c542c87036f909c5a4a395813c19aa7f2bd0797fb867b5ae1c07e570f63152f2749f6e3425cd9f9aa8b5f2c","vrfPublicKey":"mUmTQJr6dKbUTXQfOnicAaMX1yLrTWaPOdxQhPis8EA=","ApplyHeight":0,"Status":0}`
	var obj = types.Miner{}
	err := json.Unmarshal([]byte(data), &obj)
	if err != nil {
		fmt.Printf("ummarshal error:%v", err)
	}

	obj.Stake = 400
	obj.Type = common.MinerTypeValidator

	applyData, _ := json.Marshal(obj)
	//fmt.Printf("data:%v\n",string(applyData))

	tx.Data = string(applyData)
	tx.Hash = tx.GenHash()

	privateKey := common.HexStringToSecKey(privateKeyStr)
	sign := privateKey.Sign(tx.Hash.Bytes())
	tx.Sign = &sign

	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestAddMinerStakeTx(t *testing.T) {
	source := ""
	privateKey := common.HexStringToSecKey(privateKey)
	target := ""
	tx := types.Transaction{Type: 5, Source: source, Target: target, Time: utility.GetTime().String(), ChainId: "9500"}

	data := `{"id":"0x0c5a7fd40963705372dd7187c79b4b7645d8df29c39ee2a85c6d5c638b608350","publicKey":"0x8273cf5e3b46dc73c6476f91d0d192f95129ad3fb162ec4ebe9e029f901a6a335f572a899ec2efd86898b02ac2168008f8aef22c8b7967f13897fe40a925f8fa8d531022ea817537455b7c7cc50cb0d21e09739e0093790f9fffb101e4a9ed31750bf06a693a702182ed63264e51e121900b68694a054af7fa0eff1e78d10d17","vrfPublicKey":"q7uwofVvDjAGEbrCZj6D4YUz2D+ooeQ2jmIwIq9+mz8=","Stake":1}`
	//applyData, _ := json.Marshal(data)
	//fmt.Printf("data:%v\n",string(applyData))

	tx.Data = data
	tx.Hash = tx.GenHash()

	sign := privateKey.Sign(tx.Hash.Bytes())
	tx.Sign = &sign

	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestMinerRefundTx(t *testing.T) {
	source := ""
	target := ""
	tx := types.Transaction{Type: 4, Source: source, Target: target, Time: utility.GetTime().String(), ChainId: "8888"}

	tx.Data = "5"
	tx.Hash = tx.GenHash()

	privateKey := common.HexStringToSecKey(privateKey)
	sign := privateKey.Sign(tx.Hash.Bytes())
	tx.Sign = &sign

	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestChangeRewardAccountTx(t *testing.T) {
	source := ""
	privateKeyStr := ""
	tx := types.Transaction{Type: types.TransactionTypeMinerChangeAccount, Source: source, Time: utility.GetTime().String(), ChainId: "9500"}

	data := `{"id":"0x289ecde8a89bb2af023fa699f93147dd2f42dddd8418d0dd54d1d2c0969ae552","account":"0x1a9ec5d42c446da9308464034030175e687df0f2"}`
	var obj = types.Miner{}
	err := json.Unmarshal([]byte(data), &obj)
	if err != nil {
		fmt.Printf("ummarshal error:%v", err)
	}
	applyData, _ := json.Marshal(obj)
	//fmt.Printf("data:%v\n",string(applyData))

	tx.Data = string(applyData)
	tx.Hash = tx.GenHash()

	privateKey := common.HexStringToSecKey(privateKeyStr)
	sign := privateKey.Sign(tx.Hash.Bytes())
	tx.Sign = &sign

	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

//------------------------------------------------------------------------------------------------

func TestTransferTx(t *testing.T) {
	source := "0x2f4f09b722a6e5b77be17c9a99c785fa7035a09f"
	skStr := ""
	tx := types.Transaction{Type: 200, Source: source, Time: utility.GetTime().String(), ChainId: "9500"}

	abiData := "60806040523480156200001157600080fd5b5060405162005bd838038062005bd8833981016040819052620000349162000143565b600060025560408051610120810190915261010080825262005ad8602083013980516200006a9160039160209091019062000097565b50600480546001600160a01b0390921661010002610100600160a81b031990921691909117905562000173565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282620000cf57600085556200011a565b82601f10620000ea57805160ff19168380011785556200011a565b828001600101855582156200011a579182015b828111156200011a578251825591602001919060010190620000fd565b50620001289291506200012c565b5090565b5b808211156200012857600081556001016200012d565b60006020828403121562000155578081fd5b81516001600160a01b03811681146200016c578182fd5b9392505050565b61595580620001836000396000f3fe608060405234801561001057600080fd5b506004361061012c5760003560e01c8063b2744923116100ad578063d4a67bc111610071578063d4a67bc11461027e578063d7dfa0dd14610291578063e7e428b8146102a6578063f103928c146102b9578063f851a440146102cc5761012c565b8063b274492314610209578063b865d7bf1461021c578063bff1f9e11461022f578063cb5651c714610244578063cea6ab98146102575761012c565b806376c31c61116100f457806376c31c61146101a85780639bc200b4146101bb578063a5cbbe7b146101ce578063adc879e9146101e1578063b05e7792146101f65761012c565b80631272c59614610131578063184afee5146101465780631af0585a146101595780632bd4d6921461016c5780634b1933e31461017f575b600080fd5b61014461013f36600461360d565b6102e2565b005b610144610154366004613937565b6105f6565b610144610167366004613a7e565b610788565b61014461017a366004613af4565b610b41565b61019261018d366004613835565b610dea565b60405161019f9190614123565b60405180910390f35b6101446101b63660046139a6565b610ebe565b6101446101c9366004613c5d565b611118565b6101446101dc3660046136f1565b611436565b6101e9611561565b60405161019f9190615885565b610144610204366004613ce4565b61156a565b61014461021736600461378a565b61168d565b61014461022a366004613bbc565b6119e8565b610237611db3565b60405161019f9190613dd7565b61014461025236600461363d565b611db9565b61026a61026536600461360d565b6120a6565b60405161019f9897969594939291906141f2565b61014461028c3660046138b2565b6122b9565b6102996124ac565b60405161019f91906142e4565b6101446102b4366004613937565b6124c0565b6101926102c7366004613b5d565b612861565b6102d4612a09565b60405161019f929190614157565b6000818152602081905260409020546103165760405162461bcd60e51b815260040161030d9061465f565b60405180910390fd5b600081815260208190526040902060060154600160a01b900460ff1615156001146103535760405162461bcd60e51b815260040161030d9061495f565b600081815260208190526040902060090154426202a3009091011061038a5760405162461bcd60e51b815260040161030d9061495f565b600081815260208190526040902060068101805460ff60a01b19169055600a015460ff161561041457600081815260208181526040822060038101805460018181018355918552929093206007820180546002948502909201918255600890920180549294919361040c938584019361010090821615026000190116046132a4565b50505061057e565b6000805b60008381526020819052604090206003015481101561051957600083815260208190526040902060030180548290811061044e57fe5b906000526020600020906002020160010180546001816001161561010002031660029004905060001415610511576000838152602081905260409020600781015460039091018054839081106104a057fe5b600091825260208083206002909202909101929092558481529081905260409020600381018054600890920191839081106104d757fe5b906000526020600020906002020160010190805460018160011615610100020316600290046105079291906132a4565b5060019150610519565b600101610418565b508061057c576000828152602081815260408220600381018054600181810183559185529290932060078201805460029485029092019182556008909201805492949193610578938584019361010090821615026000190116046132a4565b5050505b505b6000818152602081905260408120600781018281559190829082906105a69060080182613337565b50506000600283015550600301805460ff191690556040517f09a2079356a237a448879240633063d555c93710eee983341f940fbe2ca962c7906105eb908390613dd7565b60405180910390a150565b60005b815181101561064f57606082828151811061061057fe5b602002602001015190506106258a8683612861565b15156001146106465760405162461bcd60e51b815260040161030d90615644565b506001016105f9565b5060045460009060ff1660028a8a8a8a620100018b60405160200161067b98979695949392919061406e565b60405160208183030381529060405280519060200120905061069f81878787612a9d565b15156001146106c05760405162461bcd60e51b815260040161030d906149df565b6002805460038054604080516020601f600019610100600187161502019094169690960492830186900486028101860190915281815261075c948694939192908301828280156107515780601f1061072657610100808354040283529160200191610751565b820191906000526020600020905b81548152906001019060200180831161073457829003601f168201915b505050505086612a9d565b151560011461077d5760405162461bcd60e51b815260040161030d90614d90565b505050505050505050565b6000888152602081905260409020546107b35760405162461bcd60e51b815260040161030d906152e4565b866107d05760405162461bcd60e51b815260040161030d90615276565b60028511156107f15760405162461bcd60e51b815260040161030d90614a61565b60008451116108125760405162461bcd60e51b815260040161030d90614eaf565b60028311156108335760405162461bcd60e51b815260040161030d906148c7565b60008251116108545760405162461bcd60e51b815260040161030d90614f7c565b60008151116108755760405162461bcd60e51b815260040161030d90614cad565b60008881526020819052604090206001908101540186146108a85760405162461bcd60e51b815260040161030d9061531b565b6000806000805b60008c8152602081905260409020600301548110156109fd57866000808e815260200190815260200160002060030182815481106108e957fe5b906000526020600020906002020160000154148015610953575085805190602001206000808e8152602001908152602001600020600301828154811061092b57fe5b90600052602060002090600202016001016040516109499190613e1e565b6040518091039020145b1561095d57600193505b886000808e8152602001908152602001600020600301828154811061097e57fe5b9060005260206000209060020201600001541480156109e8575087805190602001206000808e815260200190815260200160002060030182815481106109c057fe5b90600052602060002090600202016001016040516109de9190613e1e565b6040518091039020145b156109f557600192508091505b6001016108af565b506001831515148015610a1257506001821515145b610a2e5760405162461bcd60e51b815260040161030d9061583f565b60045460009060ff1660038d8d8d8d620100018e604051602001610a5998979695949392919061406e565b604051602081830303815290604052805190602001209050610a7d81888888612a9d565b1515600114610a9e5760405162461bcd60e51b815260040161030d90614928565b60008c8152602081905260409020600301805483908110610abb57fe5b60009182526020822060029091020181815590610adb6001830182613337565b505060008c81526020819052604090819020600190810180549091019055517fa1cd7cd5effcfb31cfd4a8ac01908a3beb45654a3cf90ea1a90920452d2dd0da90610b2b908e908c908c906142b2565b60405180910390a1505050505050505050505050565b606081516001600160401b0381118015610b5a57600080fd5b50604051908082528060200260200182016040528015610b84578160200160208202803683370190505b50905060008060005b8451811015610db0576000806000600460019054906101000a90046001600160a01b03166001600160a01b031663a6d38d02898681518110610bcb57fe5b60200260200101516040518263ffffffff1660e01b8152600401610bef91906142d1565b60606040518083038186803b158015610c0757600080fd5b505afa158015610c1b573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610c3f91906135d7565b919450925090506001831515148015610ca65750600289604051610c639190613de0565b602060405180830381855afa158015610c80573d6000803e3d6000fd5b5050506040513d601f19601f82011682018060405250810190610ca39190613625565b82145b15610cb657600190940193610cbe565b505050610da8565b6000805b60008c815260208190526040902060050154811015610d1b5760008c8152602081905260409020600501805482908110610cf857fe5b9060005260206000200154831415610d135760019150610d1b565b600101610cc2565b50600181151514610d3e5760405162461bcd60e51b815260040161030d90615552565b60005b87811015610d8457888181518110610d5557fe5b6020026020010151831415610d7c5760405162461bcd60e51b815260040161030d90614739565b600101610d41565b5081888881518110610d9257fe5b6020908102919091010152505060019094019350505b600101610b8d565b50600086815260208190526040902060040154811015610de25760405162461bcd60e51b815260040161030d90615493565b505050505050565b600080805b600088815260208190526040902060030154811015610eb357856000808a81526020019081526020016000206003018281548110610e2957fe5b906000526020600020906002020160000154148015610e93575084805190602001206000808a81526020019081526020016000206003018281548110610e6b57fe5b9060005260206000209060020201600101604051610e899190613e1e565b6040518091039020145b15610eab57610ea487878787612a9d565b9150610eb3565b600101610def565b509695505050505050565b600089815260208190526040902054610ee95760405162461bcd60e51b815260040161030d9061545c565b87610f065760405162461bcd60e51b815260040161030d90614c76565b6002861115610f275760405162461bcd60e51b815260040161030d90614535565b6000855111610f485760405162461bcd60e51b815260040161030d906153f7565b6000845111610f695760405162461bcd60e51b815260040161030d90615352565b6002831115610f8a5760405162461bcd60e51b815260040161030d906146a1565b6000825111610fab5760405162461bcd60e51b815260040161030d906144ce565b6000815111610fcc5760405162461bcd60e51b815260040161030d90615249565b6000898152602081905260409020600190810154018714610fff5760405162461bcd60e51b815260040161030d90614acf565b61100c8987878686612d9c565b505060045460009060ff1660018b8b8b8b620100018c60405160200161103998979695949392919061406e565b60405160208183030381529060405280519060200120905061105d81888888612a9d565b151560011461107e5760405162461bcd60e51b815260040161030d90615091565b61108a81858585612a9d565b15156001146110ab5760405162461bcd60e51b815260040161030d906151c1565b6110b68a888861302f565b60008a81526020819052604090819020600190810180549091019055517f5e28cae393d92a6a95a211db386f2974f0ea546e3eb2eb397760cc116d1bde0690611104908c908a908a906142b2565b60405180910390a150505050505050505050565b600087815260208190526040902054156111445760405162461bcd60e51b815260040161030d90614fdc565b60008651116111655760405162461bcd60e51b815260040161030d906147f6565b60028560ff1611156111895760405162461bcd60e51b815260040161030d90614e78565b60008451116111aa5760405162461bcd60e51b815260040161030d90614cda565b60008351116111cb5760405162461bcd60e51b815260040161030d90614edf565b60008251116111ec5760405162461bcd60e51b815260040161030d906157d1565b600081511161120d5760405162461bcd60e51b815260040161030d90614ba9565b60045460009060ff16818960028a6040516112289190613de0565b602060405180830381855afa158015611245573d6000803e3d6000fd5b5050506040513d601f19601f820116820180604052508101906112689190613625565b8560405160200161127d959493929190613e8e565b6040516020818303038152906040528051906020012090506112a4818760ff168787612a9d565b15156001146112c55760405162461bcd60e51b815260040161030d9061559f565b6002805460038054604080516020601f600019610100600187161502019094169690960492830186900486028101860190915281815261132b948694939192908301828280156107515780601f1061072657610100808354040283529160200191610751565b151560011461134c5760405162461bcd60e51b815260040161030d90614be0565b60048054604051639db8d7d560e01b81526000926101009092046001600160a01b031691639db8d7d591611382918d9101613dd7565b602060405180830381600087803b15801561139c57600080fd5b505af11580156113b0573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906113d49190613594565b90506113e5898860ff16888461318e565b60018054810190556040517fd3587726a4a867f63b2cf55a7e6471a8c4f04ec15eb83cff3b0dfd940be6cc1390611423908b908b90879086906141ad565b60405180910390a1505050505050505050565b856114535760405162461bcd60e51b815260040161030d90614e14565b60028311156114745760405162461bcd60e51b815260040161030d90614f45565b60008251116114955760405162461bcd60e51b815260040161030d90615389565b60008151116114b65760405162461bcd60e51b815260040161030d906155d6565b6004805460009160ff90911690898989896114d25760006114d5565b60015b6040516020016114ea96959493929190614020565b60405160208183030381529060405280519060200120905061150e81858585612a9d565b61152a5760405162461bcd60e51b815260040161030d906156de565b5050506000948552506020849052604090932060028101805460ff1916941515949094179093555050600190810180549091019055565b60045460ff1681565b6004546040516000916115899160ff90911690879087906020016140e6565b60408051808303601f1901815282825280516020918201206002805460038054600181161561010002600019011692909204601f8101859004850287018501909552848652919550611638948694929390929083018282801561162d5780601f106116025761010080835404028352916020019161162d565b820191906000526020600020905b81548152906001019060200180831161161057829003601f168201915b505050505085612a9d565b15156001146116595760405162461bcd60e51b815260040161030d90615023565b61166581868686612a9d565b15156001146116865760405162461bcd60e51b815260040161030d90614d09565b5050505050565b6000888152602081905260409020546116b85760405162461bcd60e51b815260040161030d90614a2a565b866116d55760405162461bcd60e51b815260040161030d9061505a565b60028411156116f65760405162461bcd60e51b815260040161030d906147bf565b60008351116117175760405162461bcd60e51b815260040161030d90615808565b60008251116117385760405162461bcd60e51b815260040161030d90614890565b60008151116117595760405162461bcd60e51b815260040161030d90614702565b600088815260208190526040902060019081015401861461178c5760405162461bcd60e51b815260040161030d90614b3b565b600088815260208190526040902060060154600160a01b900460ff16156117c55760405162461bcd60e51b815260040161030d9061578f565b6000805b60008a81526020819052604090206003015481101561187f57856000808c8152602001908152602001600020600301828154811061180357fe5b90600052602060002090600202016000015414801561186d575084805190602001206000808c8152602001908152602001600020600301828154811061184557fe5b90600052602060002090600202016001016040516118639190613e1e565b6040518091039020145b1561187757600191505b6001016117c9565b50801561189e5760405162461bcd60e51b815260040161030d906143a7565b600089815260208190526040902060040154825110156118d05760405162461bcd60e51b815260040161030d90614430565b6118db898484610b41565b60045460009060ff1660068b8b8b8b8b620100018c60405160200161190899989796959493929190613f9c565b60405160208183030381529060405280519060200120905061192c81878787612a9d565b6119485760405162461bcd60e51b815260040161030d9061574c565b60008a81526020818152604090912060068101805460ff60a01b1916600160a01b1790556007810188905586516119879260089092019188019061337e565b5060008a81526020819052604090819020426009820155600a8101805460ff19168a1515179055600190810180549091019055517fd6a7dfe68542b7a5e44c520ac0e66ebd706a3170fd8c8dd2f5aa36c9365d4d8a90611104908c90613dd7565b60008781526020819052604090205415611a145760405162461bcd60e51b815260040161030d9061477d565b6000865111611a355760405162461bcd60e51b815260040161030d9061560d565b6000855111611a565760405162461bcd60e51b815260040161030d90615153565b6002841115611a775760405162461bcd60e51b815260040161030d9061482b565b6000835111611a985760405162461bcd60e51b815260040161030d906148fe565b6000825111611ab95760405162461bcd60e51b815260040161030d906146d8565b6000815111611ada5760405162461bcd60e51b815260040161030d90614e4b565b60048054604051635369c68160e11b8152600092839283926101009091046001600160a01b03169163a6d38d0291611b14918c91016142d1565b60606040518083038186803b158015611b2c57600080fd5b505afa158015611b40573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611b6491906135d7565b91945092509050600183151514611b8d5760405162461bcd60e51b815260040161030d906154da565b81600286604051611b9e9190613de0565b602060405180830381855afa158015611bbb573d6000803e3d6000fd5b5050506040513d601f19601f82011682018060405250810190611bde9190613625565b14611bfb5760405162461bcd60e51b815260040161030d906145a3565b808a14611c1a5760405162461bcd60e51b815260040161030d906142f8565b60045460009060ff16818c60028d604051611c359190613de0565b602060405180830381855afa158015611c52573d6000803e3d6000fd5b5050506040513d601f19601f82011682018060405250810190611c759190613625565b88604051602001611c8a959493929190613e8e565b604051602081830303815290604052805190602001209050611cae81898989612a9d565b1515600114611ccf5760405162461bcd60e51b815260040161030d906150d6565b6000600460019054906101000a90046001600160a01b03166001600160a01b0316639db8d7d58d60001c6040518263ffffffff1660e01b8152600401611d159190613dd7565b602060405180830381600087803b158015611d2f57600080fd5b505af1158015611d43573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611d679190613594565b9050611d758c8a8a8461318e565b60018054810190556040517f53fb3b1ca8f2a8824bf8612b3224858853b3916969b6637f23647c106304e6fb90610b2b908e908e908a9086906141ad565b60015481565b600088815260208190526040902054611de45760405162461bcd60e51b815260040161030d90615699565b86611e015760405162461bcd60e51b815260040161030d90615427565b6000855111611e225760405162461bcd60e51b815260040161030d906149a8565b610100841115611e445760405162461bcd60e51b815260040161030d90614366565b6002831115611e655760405162461bcd60e51b815260040161030d90615207565b6000825111611e865760405162461bcd60e51b815260040161030d9061511c565b6000815111611ea75760405162461bcd60e51b815260040161030d90614b72565b6000888152602081905260409020600190810154018614611eda5760405162461bcd60e51b815260040161030d9061432f565b60005b600089815260208190526040902060050154811015611f71576000805b8751811015611f5c57878181518110611f0f57fe5b60200260200101516000808d81526020019081526020016000206004016001018481548110611f3a57fe5b90600052602060002001541415611f545760019150611f5c565b600101611efa565b5080611f685750611f71565b50600101611edd565b5060045460009060ff1660058a8a8a8a8a604051602001611f989796959493929190613f1d565b604051602081830303815290604052805190602001209050611fbc81858585612a9d565b611fd85760405162461bcd60e51b815260040161030d906145da565b600089815260208190526040812060048101879055611ffc916005909101906133fa565b60005b8651811015612057576000808b815260200190815260200160002060040160010187828151811061202c57fe5b6020908102919091018101518254600181810185556000948552929093209092019190915501611fff565b5060008981526020819052604090819020600190810180549091019055517f75882316f77e21f4ae2934e0615432d3125cdeaac7b5a48390adf5fa2764bae790611423908b908990899061412e565b600060208181529181526040908190208054600182015460028301548451808601865260048501805482526005860180548851818b0281018b019099528089529598949760ff90941696959294919385830193909283018282801561212a57602002820191906000526020600020905b815481526020019060010190808311612116575b5050509190925250505060068201546040805160a081018252600785018054606083019081526008870180548551602060026101006001851615026000190190931692909204601f810183900483028201830190975286815297986001600160a01b03881698600160a01b90980460ff169790968694938693608087019392908301828280156121fb5780601f106121d0576101008083540402835291602001916121fb565b820191906000526020600020905b8154815290600101906020018083116121de57829003601f168201915b50505091909252505050815260028281015460208084019190915260039093015460ff161515604092830152600b8501805483516101006001831615026000190190911692909204601f810185900485028301850190935282825293949390929091908301828280156122af5780601f10612284576101008083540402835291602001916122af565b820191906000526020600020905b81548152906001019060200180831161229257829003601f168201915b5050505050905088565b6000868152602081905260409020546122e45760405162461bcd60e51b815260040161030d90614b06565b846123015760405162461bcd60e51b815260040161030d9061456c565b60028311156123225760405162461bcd60e51b815260040161030d90614a98565b60008251116123435760405162461bcd60e51b815260040161030d906153c0565b60008151116123645760405162461bcd60e51b815260040161030d90614fac565b600086815260208190526040902060060154600160a01b900460ff1615156001146123a15760405162461bcd60e51b815260040161030d9061461b565b60045460009060ff1660098888886040516020016123c3959493929190613ed9565b6040516020818303038152906040528051906020012090506123e781858585612a9d565b6124035760405162461bcd60e51b815260040161030d90614f0e565b600087815260208190526040812060068101805460ff60a01b191690556007810182815591908290829061243a9060080182613337565b50506000600283018190556003909201805460ff19169055508781526020819052604090819020600190810180549091019055517fe8673681aeab7238cdb5ff50ee8adc5e5eb429a81b31dd9dda55e469b46942ca9061249b908990613dd7565b60405180910390a150505050505050565b60045461010090046001600160a01b031681565b6000888152602081905260409020546124eb5760405162461bcd60e51b815260040161030d906143ee565b866125085760405162461bcd60e51b815260040161030d9061518a565b60028511156125295760405162461bcd60e51b815260040161030d90615715565b600084511161254a5760405162461bcd60e51b815260040161030d90614859565b600083511161256b5760405162461bcd60e51b815260040161030d906144fe565b600082511161258c5760405162461bcd60e51b815260040161030d9061551b565b60008151116125ad5760405162461bcd60e51b815260040161030d9061448d565b60008881526020819052604090206001908101540186146125e05760405162461bcd60e51b815260040161030d90614ddd565b60005b60008981526020819052604090206003015481101561269a57856000808b8152602001908152602001600020600301828154811061261d57fe5b906000526020600020906002020160000154148015612687575084805190602001206000808b8152602001908152602001600020600301828154811061265f57fe5b906000526020600020906002020160010160405161267d9190613e1e565b6040518091039020145b156126925750612857565b6001016125e3565b506126ab88888888888888886105f6565b6000805b60008a8152602081905260409020600301548110156127a05760008a81526020819052604090206003018054829081106126e557fe5b90600052602060002090600202016001018054600181600116156101000203166002900490506000141561279857866000808c8152602001908152602001600020600301828154811061273457fe5b906000526020600020906002020160000181905550856000808c8152602001908152602001600020600301828154811061276a57fe5b9060005260206000209060020201600101908051906020019061278e92919061337e565b50600191506127a0565b6001016126af565b5080612809576127ae613418565b50604080518082018252878152602080820188815260008d81528083529384206003018054600181810183559186529483902084516002909602019485559051805193948594909361280493850192019061337e565b505050505b60008981526020819052604090819020600190810180549091019055517f2e16dda54471b1eb041d7a2c71f2cf7e11ecfd66138b239033fc216d871aa56d90611423908b90899089906142b2565b5050505050505050565b600080600080600460019054906101000a90046001600160a01b03166001600160a01b031663a6d38d02866040518263ffffffff1660e01b81526004016128a891906142d1565b60606040518083038186803b1580156128c057600080fd5b505afa1580156128d4573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906128f891906135d7565b919450925090506001831515146129215760405162461bcd60e51b815260040161030d90614d40565b6000805b60008981526020819052604090206005015481101561297e57600089815260208190526040902060050180548290811061295b57fe5b9060005260206000200154831415612976576001915061297e565b600101612925565b50600181151514612996576000945050505050612a02565b6002876040516129a69190613de0565b602060405180830381855afa1580156129c3573d6000803e3d6000fd5b5050506040513d601f19601f820116820180604052508101906129e69190613625565b83146129f9576000945050505050612a02565b60019450505050505b9392505050565b600280546003805460408051602060018416156101000260001901909316869004601f81018490048402820184019092528181529394939291830182828015612a935780601f10612a6857610100808354040283529160200191612a93565b820191906000526020600020905b815481529060010190602001808311612a7657829003601f168201915b5050505050905082565b60008084612b73576000600287604051602001612aba9190613dd7565b60408051601f1981840301815290829052612ad491613de0565b602060405180830381855afa158015612af1573d6000803e3d6000fd5b5050506040513d601f19601f82011682018060405250810190612b149190613625565b905061ff02818587604051612b2b93929190614178565b602060405180830381855afa158015612b48573d6000803e3d6000fd5b5050506040513d601f19601f82011682018060405250810190612b6b91906135bb565b915050612d93565b6001851415612d32578251604114612b9d5760405162461bcd60e51b815260040161030d906152ad565b60006040518060400160405280601c81526020017f19457468657265756d205369676e6564204d6573736167653a0a33320000000081525087604051602001612be7929190613dfc565b60408051808303601f19018152908290528051602090910120600480546306349f0b60e51b84529193506000926101009092046001600160a01b03169163c693e16091612c389186918a9101614157565b60206040518083038186803b158015612c5057600080fd5b505afa158015612c64573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612c889190613594565b60048054604051632129372760e11b815292935061010090046001600160a01b0316916342526e4e91612cbd918a91016142d1565b60206040518083038186803b158015612cd557600080fd5b505afa158015612ce9573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612d0d9190613594565b6001600160a01b0316816001600160a01b03161415612d2b57600192505b5050612d93565b6002851415612d935761ff01868486604051612d5093929190614178565b602060405180830381855afa158015612d6d573d6000803e3d6000fd5b5050506040513d601f19601f82011682018060405250810190612d9091906135bb565b90505b95945050505050565b600060606000806000606060005b60008c815260208190526040902060030154811015612ff257886000808e81526020019081526020016000206003018281548110612de457fe5b906000526020600020906002020160000154148015612e4e575087805190602001206000808e81526020019081526020016000206003018281548110612e2657fe5b9060005260206000209060020201600101604051612e449190613e1e565b6040518091039020145b15612f555760008c815260208190526040902060030180546001965082908110612e7457fe5b90600052602060002090600202016000015492506000808d81526020019081526020016000206003018181548110612ea857fe5b90600052602060002090600202016001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015612f4d5780601f10612f2257610100808354040283529160200191612f4d565b820191906000526020600020905b815481529060010190602001808311612f3057829003601f168201915b505050505091505b8a6000808e81526020019081526020016000206003018281548110612f7657fe5b906000526020600020906002020160000154148015612fe0575089805190602001206000808e81526020019081526020016000206003018281548110612fb857fe5b9060005260206000209060020201600101604051612fd69190613e1e565b6040518091039020145b15612fea57600193505b600101612daa565b506001841515148015613003575082155b61301f5760405162461bcd60e51b815260040161030d90614c24565b909a909950975050505050505050565b6000805b60008581526020819052604090206003015481101561312457600085815260208190526040902060030180548290811061306957fe5b90600052602060002090600202016001018054600181600116156101000203166002900490506000141561311c578360008087815260200190815260200160002060030182815481106130b857fe5b9060005260206000209060020201600001819055508260008087815260200190815260200160002060030182815481106130ee57fe5b9060005260206000209060020201600101908051906020019061311292919061337e565b5060019150613124565b600101613033565b508061318857613132613418565b50604080518082018252848152602080820185815260008881528083529384206003018054600181810183559186529483902084516002909602019485559051805193948594909361285793850192019061337e565b50505050565b600084815260208181526040822060016004820181905560058201805480830182559085529284209092018790558683528681558101558314156131ed576000848152602081905260409020600201805460ff19166001179055613207565b6000848152602081905260409020600201805460ff191690555b61320f613418565b50604080518082018252848152602080820185815260008881528083529384206003018054600181810183559186529483902084516002909602019485559051805193948594909361326593850192019061337e565b5050506000948552506020849052604090932060060180546001600160a01b0319166001600160a01b039094169390931760ff60a01b19169092555050565b828054600181600116156101000203166002900490600052602060002090601f0160209004810192826132da5760008555613327565b82601f106132eb5780548555613327565b8280016001018555821561332757600052602060002091601f016020900482015b8281111561332757825482559160010191906001019061330c565b50613333929150613432565b5090565b50805460018160011615610100020316600290046000825580601f1061335d575061337b565b601f01602090049060005260206000209081019061337b9190613432565b50565b828054600181600116156101000203166002900490600052602060002090601f0160209004810192826133b45760008555613327565b82601f106133cd57805160ff1916838001178555613327565b82800160010185558215613327579182015b828111156133275782518255916020019190600101906133df565b508054600082559060005260206000209081019061337b9190613432565b604051806040016040528060008152602001606081525090565b5b808211156133335760008155600101613433565b600082601f830112613457578081fd5b813561346a613465826158b6565b615893565b81815291506020808301908481018184028601820187101561348b57600080fd5b60005b848110156134aa5781358452928201929082019060010161348e565b505050505092915050565b600082601f8301126134c5578081fd5b81356134d3613465826158b6565b818152915060208083019084810160005b848110156134aa576134fb888484358a010161351d565b845292820192908201906001016134e4565b8035613518816158ff565b919050565b600082601f83011261352d578081fd5b81356001600160401b0381111561354057fe5b613553601f8201601f1916602001615893565b915080825283602082850101111561356a57600080fd5b8060208401602084013760009082016020015292915050565b803560ff8116811461351857600080fd5b6000602082840312156135a5578081fd5b81516001600160a01b0381168114612a02578182fd5b6000602082840312156135cc578081fd5b8151612a02816158ff565b6000806000606084860312156135eb578182fd5b83516135f6816158ff565b602085015160409095015190969495509392505050565b60006020828403121561361e578081fd5b5035919050565b600060208284031215613636578081fd5b5051919050565b600080600080600080600080610100898b031215613659578384fd5b88359750602089013596506040890135955060608901356001600160401b0380821115613684578586fd5b6136908c838d01613447565b965060808b0135955060a08b0135945060c08b01359150808211156136b3578384fd5b6136bf8c838d0161351d565b935060e08b01359150808211156136d4578283fd5b506136e18b828c0161351d565b9150509295985092959890939650565b600080600080600080600060e0888a03121561370b578283fd5b873596506020880135955060408801359450606088013561372b816158ff565b93506080880135925060a08801356001600160401b038082111561374d578384fd5b6137598b838c0161351d565b935060c08a013591508082111561376e578283fd5b5061377b8a828b0161351d565b91505092959891949750929550565b600080600080600080600080610100898b0312156137a6578384fd5b8835975060208901359650604089013595506137c460608a0161350d565b94506080890135935060a08901356001600160401b03808211156137e6578485fd5b6137f28c838d0161351d565b945060c08b0135915080821115613807578384fd5b6138138c838d0161351d565b935060e08b0135915080821115613828578283fd5b506136e18b828c016134b5565b600080600080600060a0868803121561384c578283fd5b85359450602086013593506040860135925060608601356001600160401b0380821115613877578283fd5b61388389838a0161351d565b93506080880135915080821115613898578283fd5b506138a58882890161351d565b9150509295509295909350565b60008060008060008060c087890312156138ca578384fd5b8635955060208701359450604087013593506060870135925060808701356001600160401b03808211156138fc578384fd5b6139088a838b0161351d565b935060a089013591508082111561391d578283fd5b5061392a89828a0161351d565b9150509295509295509295565b600080600080600080600080610100898b031215613953578182fd5b8835975060208901359650604089013595506060890135945060808901356001600160401b0380821115613985578384fd5b6139918c838d0161351d565b955060a08b01359150808211156137e6578384fd5b60008060008060008060008060006101208a8c0312156139c4578283fd5b8935985060208a0135975060408a0135965060608a0135955060808a01356001600160401b03808211156139f6578485fd5b613a028d838e0161351d565b965060a08c0135915080821115613a17578485fd5b613a238d838e0161351d565b955060c08c0135945060e08c0135915080821115613a3f578283fd5b613a4b8d838e0161351d565b93506101008c0135915080821115613a61578283fd5b50613a6e8c828d0161351d565b9150509295985092959850929598565b600080600080600080600080610100898b031215613a9a578182fd5b8835975060208901359650604089013595506060890135945060808901356001600160401b0380821115613acc578384fd5b613ad88c838d0161351d565b955060a08b0135945060c08b01359150808211156136b3578384fd5b600080600060608486031215613b08578081fd5b8335925060208401356001600160401b0380821115613b25578283fd5b613b318783880161351d565b93506040860135915080821115613b46578283fd5b50613b53868287016134b5565b9150509250925092565b600080600060608486031215613b71578081fd5b8335925060208401356001600160401b0380821115613b8e578283fd5b613b9a8783880161351d565b93506040860135915080821115613baf578283fd5b50613b538682870161351d565b600080600080600080600060e0888a031215613bd6578081fd5b8735965060208801356001600160401b0380821115613bf3578283fd5b613bff8b838c0161351d565b975060408a0135915080821115613c14578283fd5b613c208b838c0161351d565b965060608a0135955060808a0135915080821115613c3c578283fd5b613c488b838c0161351d565b945060a08a013591508082111561374d578283fd5b600080600080600080600060e0888a031215613c77578081fd5b8735965060208801356001600160401b0380821115613c94578283fd5b613ca08b838c0161351d565b9750613cae60408b01613583565b965060608a0135915080821115613cc3578283fd5b613ccf8b838c0161351d565b955060808a0135915080821115613c3c578283fd5b60008060008060808587031215613cf9578182fd5b8435935060208501356001600160401b0380821115613d16578384fd5b613d228883890161351d565b94506040870135915080821115613d37578384fd5b613d438883890161351d565b93506060870135915080821115613d58578283fd5b50613d658782880161351d565b91505092959194509250565b6000815180845260208085019450808401835b83811015613da057815187529582019590820190600101613d84565b509495945050505050565b60008151808452613dc38160208601602086016158d3565b601f01601f19169290920160200192915050565b90815260200190565b60008251613df28184602087016158d3565b9190910192915050565b60008351613e0e8184602088016158d3565b9190910191825250602001919050565b6000808354600180821660008114613e3d5760018114613e5457613e83565b60ff198316865260028304607f1686019350613e83565b600283048786526020808720875b83811015613e7b5781548a820152908501908201613e62565b505050860193505b509195945050505050565b600060ff60f81b808860f81b168352808760f81b166001840152508460028301528360228301528251613ec88160428501602087016158d3565b919091016042019695505050505050565b60f895861b6001600160f81b031990811682529490951b90931660018501526002840191909152602283015260e01b6001600160e01b031916604282015260460190565b600060ff60f81b808a60f81b1683526001818a60f81b168185015288600285015287602285015263ffffffff60e01b8760e01b1660428501526046840186516020808901865b83811015613f7e578151855293820193908201908501613f63565b5050505060f89590951b909116845290920198975050505050505050565b600060ff60f81b808c60f81b168352808b60f81b16600184015289600284015288602284015263ffffffff60e01b808960e01b16604285015287151560f81b6046850152818760f81b166047850152808660e01b1660488501525050825161400b81604c8501602087016158d3565b91909101604c019a9950505050505050505050565b60f896871b6001600160f81b0319908116825295871b861660018201526002810194909452602284019290925260e01b6001600160e01b031916604283015290921b16604682015260470190565b600060ff60f81b808b60f81b168352808a60f81b16600184015288600284015287602284015263ffffffff60e01b808860e01b166042850152818760f81b166046850152808660e01b166047850152505082516140d281604b8501602087016158d3565b91909101604b019998505050505050505050565b600060ff60f81b808660f81b168352808560f81b1660018401525082516141148160028501602087016158d3565b91909101600201949350505050565b901515815260200190565b6000848252606060208301526141476060830185613d71565b9050826040830152949350505050565b6000838252604060208301526141706040830184613dab565b949350505050565b6000848252606060208301526141916060830185613dab565b82810360408401526141a38185613dab565b9695505050505050565b6000858252608060208301526141c66080830186613dab565b82810360408401526141d88186613dab565b91505060018060a01b038316606083015295945050505050565b60006101008a835289602084015288151560408401528060608401528751818401525060208701516040610120840152614230610140840182613d71565b905060018060a01b038716608084015285151560a084015282810360c084015284516060825280516060830152602081015190506040608083015261427860a0830182613dab565b90506020860151602083015260408601511515604083015283810360e08501526142a28186613dab565b9c9b505050505050505050505050565b600084825283602083015260606040830152612d936060830184613dab565b600060208252612a026020830184613dab565b6001600160a01b0391909116815260200190565b6020808252601b908201527f726567697374657220656d61696c2066726f6d20696e76616c69640000000000604082015260600190565b6020808252601f908201527f7570646174655265636f76657279456d61696c206e6f6e6365206572726f7200604082015260600190565b60208082526021908201527f7570646174655265636f76657279456d61696c207468726573686f6c642065726040820152603960f91b606082015260800190565b60208082526027908201527f73746172745265636f76657279206e65774b6579657869737420616c726561646040820152661e48195e1a5cdd60ca1b606082015260800190565b60208082526022908201527f717569636b4164644c6f63616c4b65792075736572206973206e6f74206578696040820152611cdd60f21b606082015260800190565b60208082526038908201527f73746172745265636f7665727920636865636b20656d61696c4865616465727360408201527f2e6c656e677468203c20757365722e7468726573686f6c640000000000000000606082015260800190565b60208082526021908201527f717569636b4164644c6f63616c4b657920656d61696c486561646572732065726040820152603960f91b606082015260800190565b60208082526016908201527530b2322637b1b0b625b2bc9039b4b3a5b2bc9032b93960511b604082015260600190565b6020808252601e908201527f717569636b4164644c6f63616c4b6579206e65774b6579536967206572720000604082015260600190565b6020808252601a908201527f6164644c6f63616c4b6579206e65776b65795479706520657272000000000000604082015260600190565b6020808252601b908201527f63616e63656c5265636f7665727920757365726e616d65206572720000000000604082015260600190565b6020808252601e908201527f726567697374657220656d61696c207375626a65637420696e76616c69640000604082015260600190565b60208082526021908201527f7570646174655265636f76657279456d61696c20766572696679206661696c656040820152601960fa1b606082015260800190565b60208082526024908201527f63616e63656c5265636f766572792069735265636f766572696e672069732066604082015263616c736560e01b606082015260800190565b60208082526022908201527f636f6d706c6574655265636f766572792075736572206973206e6f74206578696040820152611cdd60f21b606082015260800190565b6020808252601a908201527f6164644c6f63616c4b6579207369674b65795479706520657272000000000000604082015260600190565b60208082526010908201526f3932b3b4b9ba32b91039b4b39032b93960811b604082015260600190565b6020808252601e908201527f73746172745265636f7665727920656d61696c48656164657273206572720000604082015260600190565b60208082526024908201527f5f73746172745265636f76657279436865636b2068617320726570656174206960408201526374656d7360e01b606082015260800190565b60208082526022908201527f726567697374657220656d61696c20686173206265656e207265676973746572604082015261195960f21b606082015260800190565b6020808252601c908201527f73746172745265636f76657279206e65774b6579547970652065727200000000604082015260600190565b6020808252818101527f717569636b5265676973746572206f726967696e557365726e616d6520657272604082015260600190565b6020808252601490820152733932b3b4b9ba32b91035b2bcaa3cb8329032b93960611b604082015260600190565b6020808252601b908201527f717569636b4164644c6f63616c4b6579206e65774b6579206572720000000000604082015260600190565b6020808252601b908201527f73746172745265636f76657279206e65774b6579536967206572720000000000604082015260600190565b6020808252601a908201527f64656c4c6f63616c4b6579207369674b65795479706520657272000000000000604082015260600190565b60208082526010908201526f3932b3b4b9ba32b91035b2bc9032b93960811b604082015260600190565b60208082526019908201527f64656c4c6f63616c4b657920766572696679206661696c656400000000000000604082015260600190565b60208082526029908201527f636f6d706c6574655265636f766572792069735265636f766572696e67206973604082015268206e6f74207472756560b81b606082015260800190565b6020808252601e908201527f7570646174655265636f76657279456d61696c20656d61696c73206572720000604082015260600190565b6020808252602b908201527f5f717569636b4164644c6f63616c4b6579436865636b20766572696679206e6560408201526a1ddad95e4819985a5b195960aa1b606082015260800190565b6020808252601f908201527f73746172745265636f766572792075736572206973206e6f7420657869737400604082015260600190565b6020808252601a908201527f64656c4c6f63616c4b65792064656c4b65795479706520657272000000000000604082015260600190565b6020808252601d908201527f63616e63656c5265636f76657279207369674b65795479706520657272000000604082015260600190565b60208082526019908201527f6164644c6f63616c4b6579206e6f6e636520696e76616c696400000000000000604082015260600190565b6020808252818101527f63616e63656c5265636f766572792075736572206973206e6f74206578697374604082015260600190565b60208082526019908201527f73746172745265636f76657279206e6f6e6365206572726f7200000000000000604082015260600190565b6020808252601b908201527f7570646174655265636f76657279456d61696c20736967206572720000000000604082015260600190565b60208082526018908201527f717569636b526567697374657220736f75726365206572720000000000000000604082015260600190565b60208082526024908201527f717569636b5265676973746572207665726966792061646d696e6b65792066616040820152631a5b195960e21b606082015260800190565b60208082526032908201527f5f6164644c6f63616c4b6579436865636b207369676b6579206e6f74206578696040820152711cdd081bdc881b995ddad95e48195e1a5cdd60721b606082015260800190565b60208082526018908201527f6164644c6f63616c4b657920757365726e616d65206572720000000000000000604082015260600190565b6020808252601390820152723232b62637b1b0b625b2bc9039b4b39032b93960691b604082015260600190565b60208082526015908201527438bab4b1b5a932b3b4b9ba32b91035b2bc9032b93960591b604082015260600190565b6020808252601d908201527f73657441646d696e20766572696679206e65776b6579206661696c6564000000604082015260600190565b60208082526030908201527f5f717569636b4164644c6f63616c4b6579436865636b3220646b696d2076657260408201526f1a599a58d85d1a5bdb8819985a5b195960821b606082015260800190565b6020808252602d908201527f5f717569636b4164644c6f63616c4b6579436865636b2076657269667920616460408201526c1b5a5b9ad95e4819985a5b1959609a1b606082015260800190565b6020808252601c908201527f717569636b4164644c6f63616c4b6579206e6f6e6365206572726f7200000000604082015260600190565b6020808252601d908201527f757064617465517569636b4c6f67696e20757365726e616d6520657272000000604082015260600190565b6020808252601390820152723932b3b4b9ba32b91039b7bab931b29032b93960691b604082015260600190565b60208082526019908201527f717569636b5265676973746572206b6579547970652065727200000000000000604082015260600190565b6020808252601690820152753232b62637b1b0b625b2bc903232b625b2bc9032b93960511b604082015260600190565b60208082526015908201527438bab4b1b5a932b3b4b9ba32b91039b4b39032b93960591b604082015260600190565b6020808252601c908201527f63616e63656c5265636f7665727920766572696679206661696c656400000000604082015260600190565b6020808252601f908201527f757064617465517569636b4c6f67696e207369674b6579547970652065727200604082015260600190565b6020808252601690820152753232b62637b1b0b625b2bc9039b4b3a5b2bc9032b93960511b604082015260600190565b60208082526016908201527531b0b731b2b62932b1b7bb32b93c9039b4b39032b93960511b604082015260600190565b60208082526027908201527f717569636b526567697374657220656d61696c20686173206265656e207265676040820152661a5cdd195c995960ca1b606082015260800190565b6020808252601d908201527f73657441646d696e20766572696679206f6c646b6579206661696c6564000000604082015260600190565b6020808252601a908201527f73746172745265636f7665727920757365726e616d6520657272000000000000604082015260600190565b60208082526025908201527f6164644c6f63616c4b6579207665726966796c6f63616c206e65776b65792066604082015264185a5b195960da1b606082015260800190565b60208082526026908201527f7265676973746572207369676e617475726520766572696669636174696f6e2060408201526519985a5b195960d21b606082015260800190565b6020808252601e908201527f7570646174655265636f76657279456d61696c207369674b6579206572720000604082015260600190565b60208082526018908201527f726567697374657220656d61696c486561646572206572720000000000000000604082015260600190565b6020808252601d908201527f717569636b4164644c6f63616c4b657920757365726e616d6520657272000000604082015260600190565b60208082526026908201527f6164644c6f63616c4b6579207665726966796c6f63616c206f6c64206b65792060408201526519985a5b195960d21b606082015260800190565b60208082526022908201527f7570646174655265636f76657279456d61696c207369674b6579547970652065604082015261393960f11b606082015260800190565b60208082526013908201527230b2322637b1b0b625b2bc9039b4b39032b93960691b604082015260600190565b60208082526018908201527f64656c4c6f63616c4b657920757365726e616d65206572720000000000000000604082015260600190565b60208082526019908201527f7665726966796c6f63616c20736967206d757374203d20363500000000000000604082015260600190565b6020808252601d908201527f64656c4c6f63616c4b65792075736572206973206e6f74206578697374000000604082015260600190565b60208082526017908201527f64656c4c6f63616c4b6579206e6f6e6365206572726f72000000000000000000604082015260600190565b60208082526019908201527f6164644c6f63616c4b6579206e65774b65795369672065727200000000000000604082015260600190565b6020808252601b908201527f757064617465517569636b4c6f67696e207369674b6579206572720000000000604082015260600190565b60208082526019908201527f63616e63656c5265636f76657279207369674b65792065727200000000000000604082015260600190565b60208082526016908201527530b2322637b1b0b625b2bc903732bba5b2bc9032b93960511b604082015260600190565b6020808252818101527f7570646174655265636f76657279456d61696c20757365726e616d6520657272604082015260600190565b6020808252601d908201527f6164644c6f63616c4b65792075736572206973206e6f74206578697374000000604082015260600190565b60208082526027908201527f5f73746172745265636f76657279436865636b2076616c6964617465446b696d6040820152660819985a5b195960ca1b606082015260800190565b60208082526021908201527f726567697374657220646b696d20766572696669636174696f6e206661696c656040820152601960fa1b606082015260800190565b6020808252601d908201527f717569636b4164644c6f63616c4b65792061646d696e53696720657272000000604082015260600190565b6020808252602d908201527f5f73746172745265636f76657279436865636b20656d61696c4865616465722060408201526c6e6f7420696e20656d61696c7360981b606082015260800190565b6020808252601b908201527f717569636b526567697374657220766572696679206661696c65640000000000604082015260600190565b60208082526018908201527f757064617465517569636b4c6f67696e20736967206572720000000000000000604082015260600190565b6020808252601b908201527f7265676973746572206f726967696e557365726e616d65206572720000000000604082015260600190565b60208082526035908201527f5f717569636b4164644c6f63616c4b6579436865636b205f717569636b416464604082015274131bd8d85b12d95e50da1958dacc8819985a5b1959605a1b606082015260800190565b60208082526025908201527f7570646174655265636f76657279456d61696c2075736572206973206e6f7420604082015264195e1a5cdd60da1b606082015260800190565b6020808252601e908201527f757064617465517569636b4c6f67696e20766572696679206661696c65640000604082015260600190565b6020808252601f908201527f717569636b4164644c6f63616c4b6579206e65774b6579547970652065727200604082015260600190565b60208082526023908201527f73746172745265636f7665727920766572696679206e6577206b6579206661696040820152621b195960ea1b606082015260800190565b60208082526022908201527f73746172745265636f766572792069735265636f766572696e67206973207472604082015261756560f01b606082015260800190565b6020808252601a908201527f717569636b52656769737465722061646d696e53696720657272000000000000604082015260600190565b60208082526018908201527f73746172745265636f76657279206e65774b6579206572720000000000000000604082015260600190565b60208082526026908201527f64656c4c6f63616c4b6579207369674b6579206f722064656c4b6579206e6f7460408201526508195e1a5cdd60d21b606082015260800190565b60ff91909116815260200190565b6040518181016001600160401b03811182821017156158ae57fe5b604052919050565b60006001600160401b038211156158c957fe5b5060209081020190565b60005b838110156158ee5781810151838201526020016158d6565b838111156131885750506000910152565b801515811461337b57600080fdfea2646970667358221220e836d4ed0a89ae8285613235a41a440130982a5113b94b04848987718e52819264736f6c6375302e372e352b636f6d6d69742e65623737656430380045d22e0abc7b19d838e954cbc6f616029686b14f2fb6848c80bcd8c8cff9a491b0da7ea160a1c93452b8c45a6a5bcec62bca0dcf181c07b9727a13dad51b719ff55c24ae0c7ae3f7868679496ec950a286922492afc61e9b3350f80501aa0cceac01e1595e09f85cab0e57902ee698c2d83c4faf663294dfe57f4b10158779bf2e0e3c78fcc52afa9eb53fcd26a69dba8c189b039ae52aab834751ab35b3dfd9f56cc7536db3e1261f94292085efba61f3495ff29c8a9f58aca9ccbb9ab157a5ef847e0250a5107c20696249d136c9fad902caa92bdc69d68819aff0807f7674a94cdd6bfcd67422f7eb27f8ca9c0919f06ffc3c76ade1ca75f17275c3b8ab7c6f"
	data := contractData{AbiData: abiData}
	dataBytes, _ := json.Marshal(data)
	tx.Data = string(dataBytes)

	tx.Hash = tx.GenHash()

	privateKey := common.HexStringToSecKey(skStr)
	sign := privateKey.Sign(tx.Hash.Bytes())
	tx.Sign = &sign
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestGetBlockNumberTx(t *testing.T) {
	source := "0x51ba50a9b4730aea7ecee86df6536297900f5b77"
	tx := types.Transaction{Type: 602, Source: source, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	data := `{"height":"11","hash":""}`
	tx.Data = string(data)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestGetBalanceTx(t *testing.T) {
	source := "0x51ba50a9b4730aea7ecee86df6536297900f5b77"
	tx := types.Transaction{Type: 99, Source: source, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	data := `{"height":"11","hash":""}`
	tx.Data = string(data)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestGetStorageTx(t *testing.T) {
	source := "0x51ba50a9b4730aea7ecee86df6536297900f5b77"
	tx := types.Transaction{Type: 609, Source: source, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	data := `{"height":"11","hash":"","address":"0x0200000000000000000000000000000000000000","key":"0x51ba50a9b4730aea7ecee86df6536297900f5b77"}`
	tx.Data = string(data)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestGetCodeTx(t *testing.T) {
	source := "0x51ba50a9b4730aea7ecee86df6536297900f5b77"
	tx := types.Transaction{Type: 610, Source: source, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	data := `{"height":"","hash":"","address":"0x9ddeb4a196da90824feceeac57e6d5f1d82b2ad7"}`
	tx.Data = string(data)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestGetBlockTx(t *testing.T) {
	source := "0x51ba50a9b4730aea7ecee86df6536297900f5b77"
	tx := types.Transaction{Type: 603, Source: source, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	data := `{"height":"","hash":"",address:"0x9ddeb4a196da90824feceeac57e6d5f1d82b2ad7"}`
	tx.Data = string(data)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestGetBlockTransactionCountTx(t *testing.T) {
	source := "0x51ba50a9b4730aea7ecee86df6536297900f5b77"
	tx := types.Transaction{Type: 607, Source: source, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	data := `{"height":"","hash":""}`
	tx.Data = string(data)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestGetTransactionTx(t *testing.T) {
	source := "0x51ba50a9b4730aea7ecee86df6536297900f5b77"
	tx := types.Transaction{Type: 605, Source: source, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	data := `{"txHash":"0xf58b553d58d2ff88a01bcf936681984802d2006b6512b5eb4e47573c81400926"}`
	tx.Data = string(data)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestGetTransactionFromBlockTx(t *testing.T) {
	source := "0x51ba50a9b4730aea7ecee86df6536297900f5b77"
	tx := types.Transaction{Type: 608, Source: source, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	data := `{"height":"","hash":"","index":"0"}`
	tx.Data = string(data)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestGetReceiptTx(t *testing.T) {
	source := "0x51ba50a9b4730aea7ecee86df6536297900f5b77"
	tx := types.Transaction{Type: 606, Source: source, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	data := `{"txHash":"0xf58b553d58d2ff88a01bcf936681984802d2006b6512b5eb4e47573c81400926"}`
	tx.Data = string(data)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestGetNonceTx(t *testing.T) {
	source := "0x51ba50a9b4730aea7ecee86df6536297900f5b77"
	tx := types.Transaction{Type: 604, Source: source, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	data := `{"height":"","hash":""}`
	tx.Data = string(data)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestGetPastLogsTx(t *testing.T) {
	source := "0x38780174572fb5b4735df1b7c69aee77ff6e9f49"
	tx := types.Transaction{Type: 611, Source: source, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	topics := [][]string{{"0x3a406d3871dab9676f7dbfa824f81f599698603527e1521006603c9118171e18"}}
	data := QueryLogData{FromBlock: 596173, ToBlock: 596173, Topics: topics}
	dataBytes, err := json.Marshal(&data)
	if err != nil {
		panic(err)
	}
	tx.Data = string(dataBytes)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

func TestCallVMTx(t *testing.T) {
	tx := types.Transaction{Type: types.TransactionTypeCallVM, Time: utility.GetTime().String()}
	tx.SocketRequestId = "111"

	data := callVMData{Height: "", Hash: ""}
	data.From = "0x38780174572fb5b4735df1b7c69aee77ff6e9f49"
	data.To = "0xa0102679651acaf63a4372314bcF69B1c898D11B"
	data.Data = "0x0a8e8e01"
	data.Gas = 1000000

	dataBytes, err := json.Marshal(&data)
	if err != nil {
		panic(err)
	}
	tx.Data = string(dataBytes)
	fmt.Printf("%s\n\n", tx.ToTxJson().ToString())
}

type contractData struct {
	GasPrice string `json:"gasPrice,omitempty"`
	GasLimit string `json:"gasLimit,omitempty"`

	TransferValue string `json:"transferValue,omitempty"`
	AbiData       string `json:"abiData,omitempty"`
}

type QueryLogData struct {
	FromBlock uint64 `json:"fromBlock,omitempty"`
	ToBlock   uint64 `json:"toBlock,omitempty"`

	Address []string   `json:"address,omitempty"`
	Topics  [][]string `json:"topics,omitempty"`
}

type callVMData struct {
	Height string `json:"height,omitempty"`
	Hash   string `json:"hash,omitempty"`

	From     string `json:"from"`
	To       string `json:"to"`
	Gas      uint64 `json:"gas"`
	GasPrice string `json:"gasPrice"`
	Value    string `json:"value"`
	Data     string `json:"data"`
}
