package vm

import (
	"com.tuntun.rocket/node/src/common"
	"com.tuntun.rocket/node/src/middleware/log"
	"com.tuntun.rocket/node/src/storage/account"
	"com.tuntun.rocket/node/src/utility"
	"com.tuntun.rocket/node/src/utility/dkim"
	"fmt"
	"golang.org/x/crypto/sha3"
	"math/big"
	"os"
	"strings"
	"testing"
)

// all pubkeys
func TestUnipassPubkey(t *testing.T) {
	sign_pubkey_map := map[string]string{
		"20161025@gmail.com":         "be23c6064e1907ae147d2a96c8089c751ee5a1d872b5a7be11845056d28384cfb59978c4a91b4ffe90d3dec0616b3926038f27da4e4d254c8c1283bc9dcdabeac500fbf0e89b98d1059a7aa832893b08c9e51fcea476a69511be611250a91b6a1204a22561bb87b79f1985a687851184533d93dfab986fc2c02830c7b12df9cf0e3259e068b974e3f6cf99fa63744c8b5b23629a4efad425fa2b29b3622443373d4c389389ececc5692e0f15b54b9f49b999fd0754db41a4fc16b8236f68555f9546311326e56c1ea1fe858e3c66f3a1282d440e3b487579dd2c198c8b15a5bab82f1516f48c4013063319c4a06789f943c5fc4e7768c2c0d4ce871c3c51a177",
		"20161025@googlemail.com":    "be23c6064e1907ae147d2a96c8089c751ee5a1d872b5a7be11845056d28384cfb59978c4a91b4ffe90d3dec0616b3926038f27da4e4d254c8c1283bc9dcdabeac500fbf0e89b98d1059a7aa832893b08c9e51fcea476a69511be611250a91b6a1204a22561bb87b79f1985a687851184533d93dfab986fc2c02830c7b12df9cf0e3259e068b974e3f6cf99fa63744c8b5b23629a4efad425fa2b29b3622443373d4c389389ececc5692e0f15b54b9f49b999fd0754db41a4fc16b8236f68555f9546311326e56c1ea1fe858e3c66f3a1282d440e3b487579dd2c198c8b15a5bab82f1516f48c4013063319c4a06789f943c5fc4e7768c2c0d4ce871c3c51a177",
		"s201512@qq.com":             "cfb0520e4ad78c4adb0deb5e605162b6469349fc1fde9269b88d596ed9f3735c00c592317c982320874b987bcc38e8556ac544bdee169b66ae8fe639828ff5afb4f199017e3d8e675a077f21cd9e5c526c1866476e7ba74cd7bb16a1c3d93bc7bb1d576aedb4307c6b948d5b8c29f79307788d7a8ebf84585bf53994827c23a5",
		"s201512@foxmail.com":        "cfb0520e4ad78c4adb0deb5e605162b6469349fc1fde9269b88d596ed9f3735c00c592317c982320874b987bcc38e8556ac544bdee169b66ae8fe639828ff5afb4f199017e3d8e675a077f21cd9e5c526c1866476e7ba74cd7bb16a1c3d93bc7bb1d576aedb4307c6b948d5b8c29f79307788d7a8ebf84585bf53994827c23a5",
		"s110527@163.com":            "a9f49a52ec4391363c089ed5c8235ee626ec286fe849a15987af68761cfa5213b418821f35e641dd602e096f15e070fd26359398dd1d5593a7540d1f0d4222fec41f5f44d5854b7e93abb0b33c4fd423ff8fc5684fccf9ef001af881b41cadeb3c79ef5c80430f143a5c9383bb50b3493711f4d3739f7268752bec431b2a8f59",
		"s110527@126.com":            "a9f49a52ec4391363c089ed5c8235ee626ec286fe849a15987af68761cfa5213b418821f35e641dd602e096f15e070fd26359398dd1d5593a7540d1f0d4222fec41f5f44d5854b7e93abb0b33c4fd423ff8fc5684fccf9ef001af881b41cadeb3c79ef5c80430f143a5c9383bb50b3493711f4d3739f7268752bec431b2a8f59",
		"s110527@yeah.net":           "a9f49a52ec4391363c089ed5c8235ee626ec286fe849a15987af68761cfa5213b418821f35e641dd602e096f15e070fd26359398dd1d5593a7540d1f0d4222fec41f5f44d5854b7e93abb0b33c4fd423ff8fc5684fccf9ef001af881b41cadeb3c79ef5c80430f143a5c9383bb50b3493711f4d3739f7268752bec431b2a8f59",
		"s110527@188.com":            "a9f49a52ec4391363c089ed5c8235ee626ec286fe849a15987af68761cfa5213b418821f35e641dd602e096f15e070fd26359398dd1d5593a7540d1f0d4222fec41f5f44d5854b7e93abb0b33c4fd423ff8fc5684fccf9ef001af881b41cadeb3c79ef5c80430f143a5c9383bb50b3493711f4d3739f7268752bec431b2a8f59",
		"s110527@vip.163.com":        "a9f49a52ec4391363c089ed5c8235ee626ec286fe849a15987af68761cfa5213b418821f35e641dd602e096f15e070fd26359398dd1d5593a7540d1f0d4222fec41f5f44d5854b7e93abb0b33c4fd423ff8fc5684fccf9ef001af881b41cadeb3c79ef5c80430f143a5c9383bb50b3493711f4d3739f7268752bec431b2a8f59",
		"s110527@vip.126.com":        "a9f49a52ec4391363c089ed5c8235ee626ec286fe849a15987af68761cfa5213b418821f35e641dd602e096f15e070fd26359398dd1d5593a7540d1f0d4222fec41f5f44d5854b7e93abb0b33c4fd423ff8fc5684fccf9ef001af881b41cadeb3c79ef5c80430f143a5c9383bb50b3493711f4d3739f7268752bec431b2a8f59",
		"s110527@vip.188.com":        "a9f49a52ec4391363c089ed5c8235ee626ec286fe849a15987af68761cfa5213b418821f35e641dd602e096f15e070fd26359398dd1d5593a7540d1f0d4222fec41f5f44d5854b7e93abb0b33c4fd423ff8fc5684fccf9ef001af881b41cadeb3c79ef5c80430f143a5c9383bb50b3493711f4d3739f7268752bec431b2a8f59",
		"s2048@yahoo.com":            "ba85ae7e06d6c39f0c7335066ccbf5efa45ac5d64638c9109a7f0e389fc71a843a75a95231688b6a3f0831c1c2d5cb9b271da0ce200f40754fb4561acb22c0e1ac89512364d74feea9f072894f2a88f084e09485ae9c5f961308295e1bb7e835b87c3bc0bce0b827f8600a11e97c54291b00a07ba817b33ebfa6cc67f5f51bebe258790197851f80943a3bc17572428aa19e4aa949091f9a436aa6e0b3e1773e9ca201441f07a104cce03528c3d15891a9ce03ed2a8ba40dc42e294c3d180ba5ee4488c84722ceaadb69428d2c6026cf47a592a467cc8b15a73ea3753d7f615e518ba614390e6c3796ea37367c4f1a109646d5472e9e28e8d49e84924e648087",
		"dbd5af2cbaf7@mail.com":      "ede596d226cb20962f0813f0f77192bffa52b5ef8668a4eee295ce446ec8f683edbb7ad2373023ff3267d44c1ba792381f68dbee3d17431db3e11f521513f126444a0cc134cb702bd693f7a000be9f0c6b57f2b67ea2462de0ef85c9929b937bd5f58e66882b82b9d23e08648318602c8de499e9b1287b6682a3f2dd3e22e2f5",
		"selector1@outlook.com":      "bd6ca4b6b20bf033bff941af31bbfb70f77f5e88296ecee9815c3ccbd95d3ba00032683cfa28c4365fdcec56f531f28ceee1b72ccc00af475554ac8cfa66e4a17da4e4bee5b11390af467d8064a9bbbc6b9d939ae7cfbfa4885dd9793f0c53e96b9f9329b5a875bb1264f44df33d11639c79f6377349c957944c8df661197663a2293b0e3fa03bbd0c5f4b26bd8e0e4df3575f34dbcfec79d67a330cb0ac8832b5e9b713a1201b84607ebb2437bdf10817d78a07bc6336533e7789ffd25bc305d3dad887db29e19b1a58b220e93df8dc9ce56edaec1911820c9f493e9c515998a6b73f94a7f0652b34fab020ab06285bfc18b7a59884041e148bfbebb8be5109",
		"selector1@hotmail.com":      "bd6ca4b6b20bf033bff941af31bbfb70f77f5e88296ecee9815c3ccbd95d3ba00032683cfa28c4365fdcec56f531f28ceee1b72ccc00af475554ac8cfa66e4a17da4e4bee5b11390af467d8064a9bbbc6b9d939ae7cfbfa4885dd9793f0c53e96b9f9329b5a875bb1264f44df33d11639c79f6377349c957944c8df661197663a2293b0e3fa03bbd0c5f4b26bd8e0e4df3575f34dbcfec79d67a330cb0ac8832b5e9b713a1201b84607ebb2437bdf10817d78a07bc6336533e7789ffd25bc305d3dad887db29e19b1a58b220e93df8dc9ce56edaec1911820c9f493e9c515998a6b73f94a7f0652b34fab020ab06285bfc18b7a59884041e148bfbebb8be5109",
		"20210112@gmail.com":         "abc27154130b1d9463d56bc83121c0a516370eb684fc4885891e88300943abd1809eb572d2d0d0c81343d46f3ed5fcb9470b2c43d0e07cd7bbac89b0c5a6d67d6c49d4b4a6a3f0f311d38738935088ffe7c3b31d986bbe47d844bc17864500269f58e43b8e8a230fe9da51af98f49edfe0150fe5f2697678bc919364a1540a7a1cb40554c878d20d3eca9c4b1a88d0f6ad5b03bf28ac254007f84c917e61d20707c954701d27da03f1c9fd36322e9ff1072d2230842c5798b26568978d005b5c19e0f669119b1da4bb33a69314ffaa9387f6b9c471df57320b16eee7408355f53e778264203341143895f8c22968315721fd756c6a12d3ca010508b23d7817d3",
		"20210112@googlemail.com":    "abc27154130b1d9463d56bc83121c0a516370eb684fc4885891e88300943abd1809eb572d2d0d0c81343d46f3ed5fcb9470b2c43d0e07cd7bbac89b0c5a6d67d6c49d4b4a6a3f0f311d38738935088ffe7c3b31d986bbe47d844bc17864500269f58e43b8e8a230fe9da51af98f49edfe0150fe5f2697678bc919364a1540a7a1cb40554c878d20d3eca9c4b1a88d0f6ad5b03bf28ac254007f84c917e61d20707c954701d27da03f1c9fd36322e9ff1072d2230842c5798b26568978d005b5c19e0f669119b1da4bb33a69314ffaa9387f6b9c471df57320b16eee7408355f53e778264203341143895f8c22968315721fd756c6a12d3ca010508b23d7817d3",
		"protonmail@protonmail.com":  "ca678aeacca0caadf24728d7d3821d41ff736da07ad1f13e185d3b8796da4526585cf867230c4a5fdadbf31e747b47b11b84e762c32e122e0097a8421141eeecc0e4fcbeae733d9ebf239d28f22b31cf9d10964bcda085b27a2350aa50cf40b41ecb441749f2f39d063f6c7c6f280a808b7dc2087c12fce3eeb96707abc0c2a9",
		"smtp@mail.unipass.me":       "be49a095a68715465a37ba5f91ba63cbb37194888d7724207801a4c4c1d2a15dfb50a239c6f279e87c3f3ad8df78dbc704910fdecf24cd53b618ebca3e5004cbe4d1e2deb99d4b32f8583cef51f4289377ca5267f4b002e8c2d98c8115a4ec944799032ada9b633b6d31043dcd6a7a84a3d7e614f861ddcd5a1284c83318a5a1fc5e4fbbc736fa2546b7be3c9ffee190e3960d00541a3b7adbb93d27ff4ea63c76069f6faa901c7ad1b52fe43a86afd54bd886f762afa0459bc470ede8d9de0d4e774f7d6179245dc22cf279268761290891f81cda728683273b195d664c378031a94b44304fdd77ca31872a7656d9c9c8a7b296117bc36364ac653a3ffc8f61",
		"eth@unipass.id":             "8d74c57e6c2736060b667c71bfa0beec86f13b89e29502f537101de6af3dc1a9e1e31d1490ddd739509d6c5ed7faecfed1392665f312939c3f0314700c2f22e38d54d3f57c423101bffa7b807f8c9e0e2619e8ecf63d1afae22ae6269126a8a9ac3b6ecbd8176f8065f275688a5598e0dc8b77a5341873c5024c2d1c0f3e628d",
		"protonmail@pm.me":           "a66408196cdf68bf5c7be5611dcad34f32bdaf19fc1f7f4f3eeff3b833b98af8baf1accc646cfc6aa3d3bcc017471d96b58bddf5b3e3897d9fb6172050fc86da55246122c4cb973ea027d69faf8e0e656cff6d1f2bad70d42d2eedf38ccd8b203a39a9d8aa133dc401a721df31b566cc219eb9ee55256be36a8d0a5f51849c39999d9d0cad3705e5b4a243ab40b9457818d1f27f2b2101e03021201bf94b4093d83e2e9e218c3bb12ee1cad100ef04d2b54ddbb42c6e1b138da18f780dea12cf7cda903556ebc1969b49c5ae0262e84add20afbe5cd11f9087d8fd181081f2169d7501b27019b2684092eef62b0c8c7c8093e3995f919516fe55e7fa01dbbda5",
		"1a1hai@icloud.com":          "d5911f6e47f84db3b64c3648ebb5a127a1bc0f0937489c806c1944fd029dc971590781df114ec072e641cdc5d2245134dc3966c8e91402669a47cc85970a281f268a44b21a4f77a91a52f9606a30c9f22d2e5cb6934263d08388091c56ac1dfbf1beea31e8a613c2a51f550d695a514d38b45c862320a00ea539419a433d6bfdd1978356cbca4b600a570fe582918c4f731a0002068df28b2a193089e6bf951c553b5a6f71aaadcc6669dfa346f322717851a8c22a324041af8736e87de4358860fff057beff3f19046a43adce46c932514988afe1309f87414bd36ed296dacfade2e0caf03235e91a2db27e9ed214bcc6e5cf995b5ef59ce9943d1f4209b6ab",
		"protonmail2@protonmail.com": "c60888c0203e5a2fa001b4bbb81ca6ae5e32c700125484b4e8f20e59a3eb5ce2ecfdae187d546a94d27f257f5dda3ad475a34439bfdc1624066bba0071e738106434fdb044e53aa2728f7fcf987817840a32893774b0bb4ec03cfdad0ca11be20d48c8410d5a3c48cb3f07a4efababac3a186755d6abc70700a3c6b88e823fbc97356117a79c27e54b88a237ca6a1cd3e35ed423dd4abcb195727472346183105960ae2828081d276ce11b8839a722b9a012990e68aca2085dfa4ca20372d6b11f4d50a3d4ac39776c371ca95d88646b65faf573cd87c06c09a11f330996b9f5b44014c369029a01182aa0064ac59e1492b6f2b00f9e0805234d0fa2772a89d1",
		"protonmail2@pm.me":          "b1dfac7052467ccf79f7870f2aa3a514effcbb0da7e5981945b386512de1fd9dd70bae840b13aac4a6083b585228825e7be1e0ea144746598e42ca340279c8039e2d13c066f33ff30bb97c231350c2c3d4169fd9d73d1fd1acf2d650ddeba77852ed8fbb8f1177ac717d4cb3eecfd38317b939ce98a858f1dc0e5dabcaf9be9636b6a24ec74d6dc532496aaa83b2d9f7191aedb595073a99baa5524093c7629f4b39ca20e6c1a17f894e18e5e44fa7ea4a7177bb4038c2bcbbab413e733494bbae41ae70ec059791b2e508f396058b9e6a2c581417f7a4f59332460f08a2565ed057182a1e34a3ece7ab9622b131472104c4fbed30c672012571847bba281b25",
	}

	os.RemoveAll("storage0")
	os.RemoveAll("1.ini")
	mockInit()
	config := new(testConfig)
	setDefaults(config)
	defer log.Close()

	config.GasLimit = 3000000
	config.GasPrice = big.NewInt(0)

	contractCodeBytes := common.Hex2Bytes("60806040523480156200001157600080fd5b50336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a36040518061022001604052806102008152602001620030906102009139600160405180807f323031363130323540676d61696c2e636f6d00000000000000000000000000008152506012019050908152602001604051809103902090805190602001906200013d92919062000b6b565b506040518061022001604052806102008152602001620030906102009139600160405180807f323031363130323540676f6f676c656d61696c2e636f6d000000000000000000815250601701905090815260200160405180910390209080519060200190620001ae92919062000b6b565b50604051806101200160405280610100815260200162002a906101009139600160405180807f733230313531324071712e636f6d000000000000000000000000000000000000815250600e019050908152602001604051809103902090805190602001906200021f92919062000b6b565b50604051806101200160405280610100815260200162002a906101009139600160405180807f7332303135313240666f786d61696c2e636f6d000000000000000000000000008152506013019050908152602001604051809103902090805190602001906200029092919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237403136332e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200030192919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237403132362e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200037292919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f7331313035323740796561682e6e657400000000000000000000000000000000815250601001905090815260200160405180910390209080519060200190620003e392919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237403138382e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200045492919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237407669702e3136332e636f6d00000000000000000000000000815250601301905090815260200160405180910390209080519060200190620004c592919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237407669702e3132362e636f6d000000000000000000000000008152506013019050908152602001604051809103902090805190602001906200053692919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237407669702e3138382e636f6d00000000000000000000000000815250601301905090815260200160405180910390209080519060200190620005a792919062000b6b565b506040518061022001604052806102008152602001620032906102009139600160405180807f7332303438407961686f6f2e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200061892919062000b6b565b506040518061012001604052806101008152602001620034906101009139600160405180807f646264356166326362616637406d61696c2e636f6d00000000000000000000008152506015019050908152602001604051809103902090805190602001906200068992919062000b6b565b506040518061022001604052806102008152602001620028906102009139600160405180807f73656c6563746f7231406f75746c6f6f6b2e636f6d0000000000000000000000815250601501905090815260200160405180910390209080519060200190620006fa92919062000b6b565b506040518061022001604052806102008152602001620028906102009139600160405180807f73656c6563746f723140686f746d61696c2e636f6d00000000000000000000008152506015019050908152602001604051809103902090805190602001906200076b92919062000b6b565b50604051806102200160405280610200815260200162002b906102009139600160405180807f323032313031313240676d61696c2e636f6d0000000000000000000000000000815250601201905090815260200160405180910390209080519060200190620007dc92919062000b6b565b50604051806102200160405280610200815260200162002b906102009139600160405180807f323032313031313240676f6f676c656d61696c2e636f6d0000000000000000008152506017019050908152602001604051809103902090805190602001906200084d92919062000b6b565b506040518061012001604052806101008152602001620020906101009139600160405180807f70726f746f6e6d61696c4070726f746f6e6d61696c2e636f6d00000000000000815250601901905090815260200160405180910390209080519060200190620008be92919062000b6b565b506040518061022001604052806102008152602001620023906102009139600160405180807f736d7470406d61696c2e756e69706173732e6d650000000000000000000000008152506014019050908152602001604051809103902090805190602001906200092f92919062000b6b565b506040518061012001604052806101008152602001620025906101009139600160405180807f65746840756e69706173732e6964000000000000000000000000000000000000815250600e01905090815260200160405180910390209080519060200190620009a092919062000b6b565b50604051806102200160405280610200815260200162002e906102009139600160405180807f70726f746f6e6d61696c40706d2e6d650000000000000000000000000000000081525060100190509081526020016040518091039020908051906020019062000a1192919062000b6b565b506040518061022001604052806102008152602001620026906102009139600160405180807f3161316861694069636c6f75642e636f6d00000000000000000000000000000081525060110190509081526020016040518091039020908051906020019062000a8292919062000b6b565b506040518061022001604052806102008152602001620021906102009139600160405180807f70726f746f6e6d61696c324070726f746f6e6d61696c2e636f6d000000000000815250601a0190509081526020016040518091039020908051906020019062000af392919062000b6b565b50604051806102200160405280610200815260200162001e906102009139600160405180807f70726f746f6e6d61696c3240706d2e6d6500000000000000000000000000000081525060110190509081526020016040518091039020908051906020019062000b6492919062000b6b565b5062000c21565b828054600181600116156101000203166002900490600052602060002090601f01602090048101928262000ba3576000855562000bef565b82601f1062000bbe57805160ff191683800117855562000bef565b8280016001018555821562000bef579182015b8281111562000bee57825182559160200191906001019062000bd1565b5b50905062000bfe919062000c02565b5090565b5b8082111562000c1d57600081600090555060010162000c03565b5090565b61125f8062000c316000396000f3fe608060405234801561001057600080fd5b50600436106100a95760003560e01c8063a19909bc11610071578063a19909bc146102a2578063a3e68bfa146103d6578063d423740b146103f6578063daa389de1461044e578063f2fde38b14610492578063f6b4c2d0146104d6576100a9565b806355c1c7e8146100ae578063715018a6146100f25780638da5cb5b146100fc5780638f32d59b146101305780639c549c4914610150575b600080fd5b6100f0600480360360208110156100c457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061060a565b005b6100fa6107d8565b005b6101046108a7565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6101386108d0565b60405180821515815260200191505060405180910390f35b6102a06004803603604081101561016657600080fd5b810190808035906020019064010000000081111561018357600080fd5b82018360208201111561019557600080fd5b803590602001918460018302840111640100000000831117156101b757600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561021a57600080fd5b82018360208201111561022c57600080fd5b8035906020019184600183028401116401000000008311171561024e57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610927565b005b61035b600480360360208110156102b857600080fd5b81019080803590602001906401000000008111156102d557600080fd5b8201836020820111156102e757600080fd5b8035906020019184600183028401116401000000008311171561030957600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610bb1565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561039b578082015181840152602081019050610380565b50505050905090810190601f1680156103c85780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6103de610cbc565b60405180821515815260200191505060405180910390f35b6104226004803603602081101561040c57600080fd5b8101908080359060200190929190505050610d5c565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6104906004803603602081101561046457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610d9b565b005b6104d4600480360360208110156104a857600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610f92565b005b61058f600480360360208110156104ec57600080fd5b810190808035906020019064010000000081111561050957600080fd5b82018360208201111561051b57600080fd5b8035906020019184600183028401116401000000008311171561053d57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610faf565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156105cf5780820151818401526020810190506105b4565b50505050905090810190601f1680156105fc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6106126108d0565b61061b57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614156106be576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f64656c736574746572207061726120657272000000000000000000000000000081525060200191505060405180910390fd5b60005b6002805490508110156107d3578173ffffffffffffffffffffffffffffffffffffffff16600282815481106106f257fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156107c6576002818154811061074657fe5b9060005260206000200160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690557f82ebf361cdb2193d0621e2b445a01e372b81d60de1dd468a29c537cbc199e14882604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a1506107d5565b80806001019150506106c1565b505b50565b6107e06108d0565b6107e957600080fd5b600073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a360008060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614905090565b61092f610cbc565b61093857600080fd5b60008251116109af576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f7365746b6579206b206572726f7200000000000000000000000000000000000081525060200191505060405180910390fd5b6000815111610a26576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f7365746b65792076206572726f7200000000000000000000000000000000000081525060200191505060405180910390fd5b806001836040518082805190602001908083835b60208310610a5d5780518252602082019150602081019050602083039250610a3a565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390209080519060200190610aa392919061116c565b507fc70190ccf4386b5b53a796ed5a973f4ded4b746d717110d2c1a661fa5355a8e38282604051808060200180602001838103835285818151815260200191508051906020019080838360005b83811015610b0b578082015181840152602081019050610af0565b50505050905090810190601f168015610b385780820380516001836020036101000a031916815260200191505b50838103825284818151815260200191508051906020019080838360005b83811015610b71578082015181840152602081019050610b56565b50505050905090810190601f168015610b9e5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a15050565b60606001826040518082805190602001908083835b60208310610be95780518252602082019150602081019050602083039250610bc6565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390208054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610cb05780601f10610c8557610100808354040283529160200191610cb0565b820191906000526020600020905b815481529060010190602001808311610c9357829003601f168201915b50505050509050919050565b600080600090505b600280549050811015610d53573373ffffffffffffffffffffffffffffffffffffffff1660028281548110610cf557fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610d46576001915050610d59565b8080600101915050610cc4565b50600090505b90565b60028181548110610d6c57600080fd5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b610da36108d0565b610dac57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415610e4f576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f616464736574746572207061726120657272000000000000000000000000000081525060200191505060405180910390fd5b60005b600280549050811015610edd578173ffffffffffffffffffffffffffffffffffffffff1660028281548110610e8357fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610ed05750610f8f565b8080600101915050610e52565b506002819080600181540180825580915050600190039060005260206000200160009091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507fd6c68344753d7b3b35f2deb4103f05c7ba6e02db4e501fabdfffeb8794da9c0781604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a15b50565b610f9a6108d0565b610fa357600080fd5b610fac81611075565b50565b6001818051602081018201805184825260208301602085012081835280955050505050506000915090508054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561106d5780601f106110425761010080835404028352916020019161106d565b820191906000526020600020905b81548152906001019060200180831161105057829003601f168201915b505050505081565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614156110af57600080fd5b8073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b828054600181600116156101000203166002900490600052602060002090601f0160209004810192826111a257600085556111e9565b82601f106111bb57805160ff19168380011785556111e9565b828001600101855582156111e9579182015b828111156111e85782518255916020019190600101906111cd565b5b5090506111f691906111fa565b5090565b5b808211156112135760008160009055506001016111fb565b509056fea26469706673582212207e4f576259738773e4477d336e2e120142f2bdc76c0986c2f497d8eb87e0eb5f64736f6c6375302e372e352b636f6d6d69742e656237376564303800456231646661633730353234363763636637396637383730663261613361353134656666636262306461376535393831393435623338363531326465316664396464373062616538343062313361616334613630383362353835323238383235653762653165306561313434373436353938653432636133343032373963383033396532643133633036366633336666333062623937633233313335306332633364343136396664396437336431666431616366326436353064646562613737383532656438666262386631313737616337313764346362336565636664333833313762393339636539386138353866316463306535646162636166396265393633366236613234656337346436646335333234393661616138336232643966373139316165646235393530373361393962616135353234303933633736323966346233396361323065366331613137663839346531386535653434666137656134613731373762623430333863326263626261623431336537333334393462626165343161653730656330353937393162326535303866333936303538623965366132633538313431376637613466353933333234363066303861323536356564303537313832613165333461336563653761623936323262313331343732313034633466626564333063363732303132353731383437626261323831623235636136373861656163636130636161646632343732386437643338323164343166663733366461303761643166313365313835643362383739366461343532363538356366383637323330633461356664616462663331653734376234376231316238346537363263333265313232653030393761383432313134316565656363306534666362656165373333643965626632333964323866323262333163663964313039363462636461303835623237613233353061613530636634306234316563623434313734396632663339643036336636633763366632383061383038623764633230383763313266636533656562393637303761626330633261396336303838386330323033653561326661303031623462626238316361366165356533326337303031323534383462346538663230653539613365623563653265636664616531383764353436613934643237663235376635646461336164343735613334343339626664633136323430363662626130303731653733383130363433346664623034346535336161323732386637666366393837383137383430613332383933373734623062623465633033636664616430636131316265323064343863383431306435613363343863623366303761346566616261626163336131383637353564366162633730373030613363366238386538323366626339373335363131376137396332376535346238386132333763613661316364336533356564343233646434616263623139353732373437323334363138333130353936306165323832383038316432373663653131623838333961373232623961303132393930653638616361323038356466613463613230333732643662313166346435306133643461633339373736633337316361393564383836343662363566616635373363643837633036633039613131663333303939366239663562343430313463333639303239613031313832616130303634616335396531343932623666326230306639653038303532333464306661323737326138396431626534396130393561363837313534363561333762613566393162613633636262333731393438383864373732343230373830316134633463316432613135646662353061323339633666323739653837633366336164386466373864626337303439313066646563663234636435336236313865626361336535303034636265346431653264656239396434623332663835383363656635316634323839333737636135323637663462303032653863326439386338313135613465633934343739393033326164613962363333623664333130343364636436613761383461336437653631346638363164646364356131323834633833333138613561316663356534666262633733366661323534366237626533633966666565313930653339363064303035343161336237616462623933643237666634656136336337363036396636666161393031633761643162353266653433613836616664353462643838366637363261666130343539626334373065646538643964653064346537373466376436313739323435646332326366323739323638373631323930383931663831636461373238363833323733623139356436363463333738303331613934623434333034666464373763613331383732613736353664396339633861376232393631313762633336333634616336353361336666633866363138643734633537653663323733363036306236363763373162666130626565633836663133623839653239353032663533373130316465366166336463316139653165333164313439306464643733393530396436633565643766616563666564313339323636356633313239333963336630333134373030633266323265333864353464336635376334323331303162666661376238303766386339653065323631396538656366363364316166616532326165363236393132366138613961633362366563626438313736663830363566323735363838613535393865306463386237376135333431383733633530323463326431633066336536323864643539313166366534376638346462336236346333363438656262356131323761316263306630393337343839633830366331393434666430323964633937313539303738316466313134656330373265363431636463356432323435313334646333393636633865393134303236363961343763633835393730613238316632363861343462323161346637376139316135326639363036613330633966323264326535636236393334323633643038333838303931633536616331646662663162656561333165386136313363326135316635353064363935613531346433386234356338363233323061303065613533393431396134333364366266646431393738333536636263613462363030613537306665353832393138633466373331613030303230363864663238623261313933303839653662663935316335353362356136663731616161646363363636396466613334366633323237313738353161386332326133323430343161663837333665383764653433353838363066666630353762656666336631393034366134336164636534366339333235313439383861666531333039663837343134626433366564323936646163666164653265306361663033323335653931613264623237653965643231346263633665356366393935623565663539636539393433643166343230396236616262643663613462366232306266303333626666393431616633316262666237306637376635653838323936656365653938313563336363626439356433626130303033323638336366613238633433363566646365633536663533316632386365656531623732636363303061663437353535346163386366613636653461313764613465346265653562313133393061663436376438303634613962626263366239643933396165376366626661343838356464393739336630633533653936623966393332396235613837356262313236346634346466333364313136333963373966363337373334396339353739343463386466363631313937363633613232393362306533666130336262643063356634623236626438653065346466333537356633346462636665633739643637613333306362306163383833326235653962373133613132303162383436303765626232343337626466313038313764373861303762633633333635333365373738396666643235626333303564336461643838376462323965313962316135386232323065393364663864633963653536656461656331393131383230633966343933653963353135393938613662373366393461376630363532623334666162303230616230363238356266633138623761353938383430343165313438626662656262386265353130396366623035323065346164373863346164623064656235653630353136326236343639333439666331666465393236396238386435393665643966333733356330306335393233313763393832333230383734623938376263633338653835353661633534346264656531363962363661653866653633393832386666356166623466313939303137653364386536373561303737663231636439653563353236633138363634373665376261373463643762623136613163336439336263376262316435373661656462343330376336623934386435623863323966373933303737383864376138656266383435383562663533393934383237633233613561626332373135343133306231643934363364353662633833313231633061353136333730656236383466633438383538393165383833303039343361626431383039656235373264326430643063383133343364343666336564356663623934373062326334336430653037636437626261633839623063356136643637643663343964346234613661336630663331316433383733383933353038386666653763336233316439383662626534376438343462633137383634353030323639663538653433623865386132333066653964613531616639386634396564666530313530666535663236393736373862633931393336346131353430613761316362343035353463383738643230643365636139633462316138386430663661643562303362663238616332353430303766383463393137653631643230373037633935343730316432376461303366316339666433363332326539666631303732643232333038343263353739386232363536383937386430303562356331396530663636393131396231646134626233336136393331346666616139333837663662396334373164663537333230623136656565373430383335356635336537373832363432303333343131343338393566386332323936383331353732316664373536633661313264336361303130353038623233643738313764336139663439613532656334333931333633633038396564356338323335656536323665633238366665383439613135393837616636383736316366613532313362343138383231663335653634316464363032653039366631356530373066643236333539333938646431643535393361373534306431663064343232326665633431663566343464353835346237653933616262306233336334666434323366663866633536383466636366396566303031616638383162343163616465623363373965663563383034333066313433613563393338336262353062333439333731316634643337333966373236383735326265633433316232613866353961363634303831393663646636386266356337626535363131646361643334663332626461663139666331663766346633656566663362383333623938616638626166316163636336343663666336616133643362636330313734373164393662353862646466356233653338393764396662363137323035306663383664613535323436313232633463623937336561303237643639666166386530653635366366663664316632626164373064343264326565646633386363643862323033613339613964386161313333646334303161373231646633316235363663633231396562396565353532353662653336613864306135663531383439633339393939643964306361643337303565356234613234336162343062393435373831386431663237663262323130316530333032313230316266393462343039336438336532653965323138633362623132656531636164313030656630346432623534646462623432633665316231333864613138663738306465613132636637636461393033353536656263313936396234396335616530323632653834616464323061666265356364313166393038376438666431383130383166323136396437353031623237303139623236383430393265656636326230633863376338303933653339393566393139353136666535356537666130316462626461356265323363363036346531393037616531343764326139366338303839633735316565356131643837326235613762653131383435303536643238333834636662353939373863346139316234666665393064336465633036313662333932363033386632376461346534643235346338633132383362633964636461626561633530306662663065383962393864313035396137616138333238393362303863396535316663656134373661363935313162653631313235306139316236613132303461323235363162623837623739663139383561363837383531313834353333643933646661623938366663326330323833306337623132646639636630653332353965303638623937346533663663663939666136333734346338623562323336323961346566616434323566613262323962333632323434333337336434633338393338396563656363353639326530663135623534623966343962393939666430373534646234316134666331366238323336663638353535663935343633313133323665353663316561316665383538653363363666336131323832643434306533623438373537396464326331393863386231356135626162383266313531366634386334303133303633333139633461303637383966393433633566633465373736386332633064346365383731633363353161313737626138356165376530366436633339663063373333353036366363626635656661343561633564363436333863393130396137663065333839666337316138343361373561393532333136383862366133663038333163316332643563623962323731646130636532303066343037353466623435363161636232326330653161633839353132333634643734666565613966303732383934663261383866303834653039343835616539633566393631333038323935653162623765383335623837633362633062636530623832376638363030613131653937633534323931623030613037626138313762333365626661366363363766356635316265626532353837393031393738353166383039343361336263313735373234323861613139653461613934393039316639613433366161366530623365313737336539636132303134343166303761313034636365303335323863336431353839316139636530336564326138626134306463343265323934633364313830626135656534343838633834373232636561616462363934323864326336303236636634376135393261343637636338623135613733656133373533643766363135653531386261363134333930653663333739366561333733363763346631613130393634366435343732653965323865386434396538343932346536343830383765646535393664323236636232303936326630383133663066373731393262666661353262356566383636386134656565323935636534343665633866363833656462623761643233373330323366663332363764343463316261373932333831663638646265653364313734333164623365313166353231353133663132363434346130636331333463623730326264363933663761303030626539663063366235376632623637656132343632646530656638356339393239623933376264356635386536363838326238326239643233653038363438333138363032633864653439396539623132383762363638326133663264643365323265326635")
	createResult, contractAddress, createLeftGas, createErr := mockCreate(contractCodeBytes, config)
	fmt.Printf("New create contract address:%s\n", contractAddress.GetHexString())
	fmt.Printf("New create contract createResult:%v\n", createResult)
	fmt.Printf("New create contract createLeftGas:%v,createErr:%v\n", createLeftGas, createErr)
	fmt.Println(len(config.State.GetCode(contractAddress)))

	root, err := config.State.Commit(true)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	trieDB := config.AccountDatabase.TrieDB()
	err = trieDB.Commit(root, false)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	db, err := account.NewAccountDB(root, config.AccountDatabase)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	for key, value := range sign_pubkey_map {
		current := dkim.GetEmailPubKey(contractAddress, key, db)
		if 0 != strings.Compare(value, current) {
			t.Fatalf(key)
		}
	}

}

// 1 pubkey
func TestUnipassPubkey2(t *testing.T) {
	os.RemoveAll("storage0")
	os.RemoveAll("1.ini")
	mockInit()
	config := new(testConfig)
	setDefaults(config)
	defer log.Close()

	config.GasLimit = 3000000
	config.GasPrice = big.NewInt(0)

	contractCodeBytes := common.Hex2Bytes("60806040523480156200001157600080fd5b50336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a36040518061022001604052806102008152602001620014696102009139600160405180807f323031363130323540676d61696c2e636f6d00000000000000000000000000008152506012019050908152602001604051809103902090805190602001906200013d92919062000144565b50620001fa565b828054600181600116156101000203166002900490600052602060002090601f0160209004810192826200017c5760008555620001c8565b82601f106200019757805160ff1916838001178555620001c8565b82800160010185558215620001c8579182015b82811115620001c7578251825591602001919060010190620001aa565b5b509050620001d79190620001db565b5090565b5b80821115620001f6576000816000905550600101620001dc565b5090565b61125f806200020a6000396000f3fe608060405234801561001057600080fd5b50600436106100a95760003560e01c8063a19909bc11610071578063a19909bc146102a2578063a3e68bfa146103d6578063d423740b146103f6578063daa389de1461044e578063f2fde38b14610492578063f6b4c2d0146104d6576100a9565b806355c1c7e8146100ae578063715018a6146100f25780638da5cb5b146100fc5780638f32d59b146101305780639c549c4914610150575b600080fd5b6100f0600480360360208110156100c457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061060a565b005b6100fa6107d8565b005b6101046108a7565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6101386108d0565b60405180821515815260200191505060405180910390f35b6102a06004803603604081101561016657600080fd5b810190808035906020019064010000000081111561018357600080fd5b82018360208201111561019557600080fd5b803590602001918460018302840111640100000000831117156101b757600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561021a57600080fd5b82018360208201111561022c57600080fd5b8035906020019184600183028401116401000000008311171561024e57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610927565b005b61035b600480360360208110156102b857600080fd5b81019080803590602001906401000000008111156102d557600080fd5b8201836020820111156102e757600080fd5b8035906020019184600183028401116401000000008311171561030957600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610bb1565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561039b578082015181840152602081019050610380565b50505050905090810190601f1680156103c85780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6103de610cbc565b60405180821515815260200191505060405180910390f35b6104226004803603602081101561040c57600080fd5b8101908080359060200190929190505050610d5c565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6104906004803603602081101561046457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610d9b565b005b6104d4600480360360208110156104a857600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610f92565b005b61058f600480360360208110156104ec57600080fd5b810190808035906020019064010000000081111561050957600080fd5b82018360208201111561051b57600080fd5b8035906020019184600183028401116401000000008311171561053d57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610faf565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156105cf5780820151818401526020810190506105b4565b50505050905090810190601f1680156105fc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6106126108d0565b61061b57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614156106be576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f64656c736574746572207061726120657272000000000000000000000000000081525060200191505060405180910390fd5b60005b6002805490508110156107d3578173ffffffffffffffffffffffffffffffffffffffff16600282815481106106f257fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156107c6576002818154811061074657fe5b9060005260206000200160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690557f82ebf361cdb2193d0621e2b445a01e372b81d60de1dd468a29c537cbc199e14882604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a1506107d5565b80806001019150506106c1565b505b50565b6107e06108d0565b6107e957600080fd5b600073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a360008060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614905090565b61092f610cbc565b61093857600080fd5b60008251116109af576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f7365746b6579206b206572726f7200000000000000000000000000000000000081525060200191505060405180910390fd5b6000815111610a26576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f7365746b65792076206572726f7200000000000000000000000000000000000081525060200191505060405180910390fd5b806001836040518082805190602001908083835b60208310610a5d5780518252602082019150602081019050602083039250610a3a565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390209080519060200190610aa392919061116c565b507fc70190ccf4386b5b53a796ed5a973f4ded4b746d717110d2c1a661fa5355a8e38282604051808060200180602001838103835285818151815260200191508051906020019080838360005b83811015610b0b578082015181840152602081019050610af0565b50505050905090810190601f168015610b385780820380516001836020036101000a031916815260200191505b50838103825284818151815260200191508051906020019080838360005b83811015610b71578082015181840152602081019050610b56565b50505050905090810190601f168015610b9e5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a15050565b60606001826040518082805190602001908083835b60208310610be95780518252602082019150602081019050602083039250610bc6565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390208054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610cb05780601f10610c8557610100808354040283529160200191610cb0565b820191906000526020600020905b815481529060010190602001808311610c9357829003601f168201915b50505050509050919050565b600080600090505b600280549050811015610d53573373ffffffffffffffffffffffffffffffffffffffff1660028281548110610cf557fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610d46576001915050610d59565b8080600101915050610cc4565b50600090505b90565b60028181548110610d6c57600080fd5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b610da36108d0565b610dac57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415610e4f576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f616464736574746572207061726120657272000000000000000000000000000081525060200191505060405180910390fd5b60005b600280549050811015610edd578173ffffffffffffffffffffffffffffffffffffffff1660028281548110610e8357fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610ed05750610f8f565b8080600101915050610e52565b506002819080600181540180825580915050600190039060005260206000200160009091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507fd6c68344753d7b3b35f2deb4103f05c7ba6e02db4e501fabdfffeb8794da9c0781604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a15b50565b610f9a6108d0565b610fa357600080fd5b610fac81611075565b50565b6001818051602081018201805184825260208301602085012081835280955050505050506000915090508054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561106d5780601f106110425761010080835404028352916020019161106d565b820191906000526020600020905b81548152906001019060200180831161105057829003601f168201915b505050505081565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614156110af57600080fd5b8073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b828054600181600116156101000203166002900490600052602060002090601f0160209004810192826111a257600085556111e9565b82601f106111bb57805160ff19168380011785556111e9565b828001600101855582156111e9579182015b828111156111e85782518255916020019190600101906111cd565b5b5090506111f691906111fa565b5090565b5b808211156112135760008160009055506001016111fb565b509056fea2646970667358221220e2cb0c3f96daabe8ef82032e7d6dc467b683ed970bda63b36e8c5ace618f6a4e64736f6c6375302e372e352b636f6d6d69742e656237376564303800456265323363363036346531393037616531343764326139366338303839633735316565356131643837326235613762653131383435303536643238333834636662353939373863346139316234666665393064336465633036313662333932363033386632376461346534643235346338633132383362633964636461626561633530306662663065383962393864313035396137616138333238393362303863396535316663656134373661363935313162653631313235306139316236613132303461323235363162623837623739663139383561363837383531313834353333643933646661623938366663326330323833306337623132646639636630653332353965303638623937346533663663663939666136333734346338623562323336323961346566616434323566613262323962333632323434333337336434633338393338396563656363353639326530663135623534623966343962393939666430373534646234316134666331366238323336663638353535663935343633313133323665353663316561316665383538653363363666336131323832643434306533623438373537396464326331393863386231356135626162383266313531366634386334303133303633333139633461303637383966393433633566633465373736386332633064346365383731633363353161313737")
	createResult, contractAddress, createLeftGas, createErr := mockCreate(contractCodeBytes, config)
	fmt.Printf("New create contract address:%s\n", contractAddress.GetHexString())
	fmt.Printf("New create contract createResult:%v\n", createResult)
	fmt.Printf("New create contract createLeftGas:%v,createErr:%v\n", createLeftGas, createErr)
	fmt.Println(len(config.State.GetCode(contractAddress)))

	//root, err := config.State.Commit(true)
	//if err != nil {
	//	t.Errorf("State commit error:%s", err.Error())
	//}
	//
	//trieDB := config.AccountDatabase.TrieDB()
	//err = trieDB.Commit(root, false)
	//if err != nil {
	//	t.Errorf("State commit error:%s", err.Error())
	//}
	//
	//db, err := account.NewAccountDB(root, config.AccountDatabase)
	//if err != nil {
	//	t.Errorf("State commit error:%s", err.Error())
	//}
	//
	//iter := db.DataIterator(contractAddress, []byte(""))
	//for iter.Next() {
	//	fmt.Println("key: " + common.ToHex(iter.Key))
	//	fmt.Println("value: " + common.ToHex(iter.Value))
	//}

}

// 2 pubkeys
func TestUnipassPubkey3(t *testing.T) {
	os.RemoveAll("storage0")
	os.RemoveAll("1.ini")
	mockInit()
	config := new(testConfig)
	setDefaults(config)
	defer log.Close()

	config.GasLimit = 3000000
	config.GasPrice = big.NewInt(0)

	contractCodeBytes := common.Hex2Bytes("60806040523480156200001157600080fd5b50336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a36040518061022001604052806102008152602001620014da6102009139600160405180807f323031363130323540676d61696c2e636f6d00000000000000000000000000008152506012019050908152602001604051809103902090805190602001906200013d929190620001b5565b506040518061022001604052806102008152602001620014da6102009139600160405180807f323031363130323540676f6f676c656d61696c2e636f6d000000000000000000815250601701905090815260200160405180910390209080519060200190620001ae929190620001b5565b506200026b565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282620001ed576000855562000239565b82601f106200020857805160ff191683800117855562000239565b8280016001018555821562000239579182015b82811115620002385782518255916020019190600101906200021b565b5b5090506200024891906200024c565b5090565b5b80821115620002675760008160009055506001016200024d565b5090565b61125f806200027b6000396000f3fe608060405234801561001057600080fd5b50600436106100a95760003560e01c8063a19909bc11610071578063a19909bc146102a2578063a3e68bfa146103d6578063d423740b146103f6578063daa389de1461044e578063f2fde38b14610492578063f6b4c2d0146104d6576100a9565b806355c1c7e8146100ae578063715018a6146100f25780638da5cb5b146100fc5780638f32d59b146101305780639c549c4914610150575b600080fd5b6100f0600480360360208110156100c457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061060a565b005b6100fa6107d8565b005b6101046108a7565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6101386108d0565b60405180821515815260200191505060405180910390f35b6102a06004803603604081101561016657600080fd5b810190808035906020019064010000000081111561018357600080fd5b82018360208201111561019557600080fd5b803590602001918460018302840111640100000000831117156101b757600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561021a57600080fd5b82018360208201111561022c57600080fd5b8035906020019184600183028401116401000000008311171561024e57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610927565b005b61035b600480360360208110156102b857600080fd5b81019080803590602001906401000000008111156102d557600080fd5b8201836020820111156102e757600080fd5b8035906020019184600183028401116401000000008311171561030957600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610bb1565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561039b578082015181840152602081019050610380565b50505050905090810190601f1680156103c85780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6103de610cbc565b60405180821515815260200191505060405180910390f35b6104226004803603602081101561040c57600080fd5b8101908080359060200190929190505050610d5c565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6104906004803603602081101561046457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610d9b565b005b6104d4600480360360208110156104a857600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610f92565b005b61058f600480360360208110156104ec57600080fd5b810190808035906020019064010000000081111561050957600080fd5b82018360208201111561051b57600080fd5b8035906020019184600183028401116401000000008311171561053d57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610faf565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156105cf5780820151818401526020810190506105b4565b50505050905090810190601f1680156105fc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6106126108d0565b61061b57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614156106be576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f64656c736574746572207061726120657272000000000000000000000000000081525060200191505060405180910390fd5b60005b6002805490508110156107d3578173ffffffffffffffffffffffffffffffffffffffff16600282815481106106f257fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156107c6576002818154811061074657fe5b9060005260206000200160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690557f82ebf361cdb2193d0621e2b445a01e372b81d60de1dd468a29c537cbc199e14882604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a1506107d5565b80806001019150506106c1565b505b50565b6107e06108d0565b6107e957600080fd5b600073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a360008060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614905090565b61092f610cbc565b61093857600080fd5b60008251116109af576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f7365746b6579206b206572726f7200000000000000000000000000000000000081525060200191505060405180910390fd5b6000815111610a26576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f7365746b65792076206572726f7200000000000000000000000000000000000081525060200191505060405180910390fd5b806001836040518082805190602001908083835b60208310610a5d5780518252602082019150602081019050602083039250610a3a565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390209080519060200190610aa392919061116c565b507fc70190ccf4386b5b53a796ed5a973f4ded4b746d717110d2c1a661fa5355a8e38282604051808060200180602001838103835285818151815260200191508051906020019080838360005b83811015610b0b578082015181840152602081019050610af0565b50505050905090810190601f168015610b385780820380516001836020036101000a031916815260200191505b50838103825284818151815260200191508051906020019080838360005b83811015610b71578082015181840152602081019050610b56565b50505050905090810190601f168015610b9e5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a15050565b60606001826040518082805190602001908083835b60208310610be95780518252602082019150602081019050602083039250610bc6565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390208054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610cb05780601f10610c8557610100808354040283529160200191610cb0565b820191906000526020600020905b815481529060010190602001808311610c9357829003601f168201915b50505050509050919050565b600080600090505b600280549050811015610d53573373ffffffffffffffffffffffffffffffffffffffff1660028281548110610cf557fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610d46576001915050610d59565b8080600101915050610cc4565b50600090505b90565b60028181548110610d6c57600080fd5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b610da36108d0565b610dac57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415610e4f576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f616464736574746572207061726120657272000000000000000000000000000081525060200191505060405180910390fd5b60005b600280549050811015610edd578173ffffffffffffffffffffffffffffffffffffffff1660028281548110610e8357fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610ed05750610f8f565b8080600101915050610e52565b506002819080600181540180825580915050600190039060005260206000200160009091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507fd6c68344753d7b3b35f2deb4103f05c7ba6e02db4e501fabdfffeb8794da9c0781604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a15b50565b610f9a6108d0565b610fa357600080fd5b610fac81611075565b50565b6001818051602081018201805184825260208301602085012081835280955050505050506000915090508054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561106d5780601f106110425761010080835404028352916020019161106d565b820191906000526020600020905b81548152906001019060200180831161105057829003601f168201915b505050505081565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614156110af57600080fd5b8073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b828054600181600116156101000203166002900490600052602060002090601f0160209004810192826111a257600085556111e9565b82601f106111bb57805160ff19168380011785556111e9565b828001600101855582156111e9579182015b828111156111e85782518255916020019190600101906111cd565b5b5090506111f691906111fa565b5090565b5b808211156112135760008160009055506001016111fb565b509056fea26469706673582212201dc37d244fac55b03c6cec173489fccbaefc9f504aa526819a3a858d1eb75fea64736f6c6375302e372e352b636f6d6d69742e656237376564303800456265323363363036346531393037616531343764326139366338303839633735316565356131643837326235613762653131383435303536643238333834636662353939373863346139316234666665393064336465633036313662333932363033386632376461346534643235346338633132383362633964636461626561633530306662663065383962393864313035396137616138333238393362303863396535316663656134373661363935313162653631313235306139316236613132303461323235363162623837623739663139383561363837383531313834353333643933646661623938366663326330323833306337623132646639636630653332353965303638623937346533663663663939666136333734346338623562323336323961346566616434323566613262323962333632323434333337336434633338393338396563656363353639326530663135623534623966343962393939666430373534646234316134666331366238323336663638353535663935343633313133323665353663316561316665383538653363363666336131323832643434306533623438373537396464326331393863386231356135626162383266313531366634386334303133303633333139633461303637383966393433633566633465373736386332633064346365383731633363353161313737")
	createResult, contractAddress, createLeftGas, createErr := mockCreate(contractCodeBytes, config)
	fmt.Printf("New create contract address:%s\n", contractAddress.GetHexString())
	fmt.Printf("New create contract createResult:%v\n", createResult)
	fmt.Printf("New create contract createLeftGas:%v,createErr:%v\n", createLeftGas, createErr)
	fmt.Println(len(config.State.GetCode(contractAddress)))

	root, err := config.State.Commit(true)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	trieDB := config.AccountDatabase.TrieDB()
	err = trieDB.Commit(root, false)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	db, err := account.NewAccountDB(root, config.AccountDatabase)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	iter := db.DataIterator(contractAddress, []byte(""))
	for iter.Next() {
		fmt.Println("key: " + common.ToHex(iter.Key))
		fmt.Println("value: " + common.ToHex(iter.Value))
	}

}

func Test_encode(t *testing.T) {
	str := "be23c6064e1907ae147d2a96c8089c751ee5a1d872b5a7be11845056d28384cfb59978c4a91b4ffe90d3dec0616b3926038f27da4e4d254c8c1283bc9dcdabeac500fbf0e89b98d1059a7aa832893b08c9e51fcea476a69511be611250a91b6a1204a22561bb87b79f1985a687851184533d93dfab986fc2c02830c7b12df9cf0e3259e068b974e3f6cf99fa63744c8b5b23629a4efad425fa2b29b3622443373d4c389389ececc5692e0f15b54b9f49b999fd0754db41a4fc16b8236f68555f9546311326e56c1ea1fe858e3c66f3a1282d440e3b487579dd2c198c8b15a5bab82f1516f48c4013063319c4a06789f943c5fc4e7768c2c0d4ce871c3c51a177"
	fmt.Println(common.ToHex(utility.StrToBytes(str)))

	fmt.Println(utility.BytesToStr(common.FromHex("0x6265323363363036346531393037616531343764326139366338303839633735316565356131643837326235613762653131383435303536643238333834636662353939373863346139316234666665393064336465633036313662333932363033386632376461346534643235346338633132383362633964636461626561633530306662663065383962393864313035396137616138333238393362303863396535316663656134373661363935313162653631313235306139316236613132303461323235363162623837623739663139383561363837383531313834353333643933646661623938366663326330323833306337623132646639636630653332353965303638623937346533663663663939666136333734346338623562323336323961346566616434323566613262323962333632323434333337336434633338393338396563656363353639326530663135623534623966343962393939666430373534646234316134666331366238323336663638353535663935343633313133323665353663316561316665383538653363363666336131323832643434306533623438373537396464326331393863386231356135626162383266313531366634386334303133303633333139633461303637383966393433633566633465373736386332633064346365383731633363353161313737")))
}

func Test_Position(t *testing.T) {
	hasher := sha3.NewLegacyKeccak256().(common.KeccakState)

	positon := [32]byte{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
	hasher.Write(positon[:])
	result := [32]byte{}
	hasher.Read(result[:])

	fmt.Println(common.ToHex(result[:])) //0x290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e563
}

func Test_Position2(t *testing.T) {
	//hasher := sha3.NewLegacyKeccak256().(common.KeccakState)
	key := "20161025@gmail.com"

	keyBytes := utility.StrToBytes(key)
	positionBytes := []byte{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1}
	data := append(keyBytes, positionBytes...)
	fmt.Println(data)

	hasher2 := sha3.NewLegacyKeccak256().(common.KeccakState)
	hasher2.Write(data[:])
	result := [32]byte{}
	hasher2.Read(result[:])

	fmt.Println(common.ToHex(result[:]))
}

func Test_Postion3(t *testing.T) {
	hasher := sha3.NewLegacyKeccak256().(common.KeccakState)
	hasher.Write(common.FromHex("0xad5830e91e64013baffb5569d6a653c9de693cab7c01bc27c10a9bca07eef5bd"))
	keyHash := [32]byte{}
	hasher.Read(keyHash[:])

	length := new(big.Int)
	length.SetBytes(common.FromHex("0x0401"))
	size := (length.Uint64() - 1) / 64

	num := new(big.Int)
	num.SetBytes(keyHash[:])

	for i := 0; i < int(size); i++ {
		fmt.Println(common.ToHex(num.Bytes()))
		num = num.Add(num, big.NewInt(1))
	}
	fmt.Println()
}

func TestVerify2(t *testing.T) {
	os.RemoveAll("storage0")
	os.RemoveAll("1.ini")
	mockInit()
	config := new(testConfig)
	setDefaults(config)
	defer log.Close()

	config.GasLimit = 3000000
	config.GasPrice = big.NewInt(0)

	contractCodeBytes := common.Hex2Bytes("60806040523480156200001157600080fd5b50336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a36040518061022001604052806102008152602001620030906102009139600160405180807f323031363130323540676d61696c2e636f6d00000000000000000000000000008152506012019050908152602001604051809103902090805190602001906200013d92919062000b6b565b506040518061022001604052806102008152602001620030906102009139600160405180807f323031363130323540676f6f676c656d61696c2e636f6d000000000000000000815250601701905090815260200160405180910390209080519060200190620001ae92919062000b6b565b50604051806101200160405280610100815260200162002a906101009139600160405180807f733230313531324071712e636f6d000000000000000000000000000000000000815250600e019050908152602001604051809103902090805190602001906200021f92919062000b6b565b50604051806101200160405280610100815260200162002a906101009139600160405180807f7332303135313240666f786d61696c2e636f6d000000000000000000000000008152506013019050908152602001604051809103902090805190602001906200029092919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237403136332e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200030192919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237403132362e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200037292919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f7331313035323740796561682e6e657400000000000000000000000000000000815250601001905090815260200160405180910390209080519060200190620003e392919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237403138382e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200045492919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237407669702e3136332e636f6d00000000000000000000000000815250601301905090815260200160405180910390209080519060200190620004c592919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237407669702e3132362e636f6d000000000000000000000000008152506013019050908152602001604051809103902090805190602001906200053692919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237407669702e3138382e636f6d00000000000000000000000000815250601301905090815260200160405180910390209080519060200190620005a792919062000b6b565b506040518061022001604052806102008152602001620032906102009139600160405180807f7332303438407961686f6f2e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200061892919062000b6b565b506040518061012001604052806101008152602001620034906101009139600160405180807f646264356166326362616637406d61696c2e636f6d00000000000000000000008152506015019050908152602001604051809103902090805190602001906200068992919062000b6b565b506040518061022001604052806102008152602001620028906102009139600160405180807f73656c6563746f7231406f75746c6f6f6b2e636f6d0000000000000000000000815250601501905090815260200160405180910390209080519060200190620006fa92919062000b6b565b506040518061022001604052806102008152602001620028906102009139600160405180807f73656c6563746f723140686f746d61696c2e636f6d00000000000000000000008152506015019050908152602001604051809103902090805190602001906200076b92919062000b6b565b50604051806102200160405280610200815260200162002b906102009139600160405180807f323032313031313240676d61696c2e636f6d0000000000000000000000000000815250601201905090815260200160405180910390209080519060200190620007dc92919062000b6b565b50604051806102200160405280610200815260200162002b906102009139600160405180807f323032313031313240676f6f676c656d61696c2e636f6d0000000000000000008152506017019050908152602001604051809103902090805190602001906200084d92919062000b6b565b506040518061012001604052806101008152602001620020906101009139600160405180807f70726f746f6e6d61696c4070726f746f6e6d61696c2e636f6d00000000000000815250601901905090815260200160405180910390209080519060200190620008be92919062000b6b565b506040518061022001604052806102008152602001620023906102009139600160405180807f736d7470406d61696c2e756e69706173732e6d650000000000000000000000008152506014019050908152602001604051809103902090805190602001906200092f92919062000b6b565b506040518061012001604052806101008152602001620025906101009139600160405180807f65746840756e69706173732e6964000000000000000000000000000000000000815250600e01905090815260200160405180910390209080519060200190620009a092919062000b6b565b50604051806102200160405280610200815260200162002e906102009139600160405180807f70726f746f6e6d61696c40706d2e6d650000000000000000000000000000000081525060100190509081526020016040518091039020908051906020019062000a1192919062000b6b565b506040518061022001604052806102008152602001620026906102009139600160405180807f3161316861694069636c6f75642e636f6d00000000000000000000000000000081525060110190509081526020016040518091039020908051906020019062000a8292919062000b6b565b506040518061022001604052806102008152602001620021906102009139600160405180807f70726f746f6e6d61696c324070726f746f6e6d61696c2e636f6d000000000000815250601a0190509081526020016040518091039020908051906020019062000af392919062000b6b565b50604051806102200160405280610200815260200162001e906102009139600160405180807f70726f746f6e6d61696c3240706d2e6d6500000000000000000000000000000081525060110190509081526020016040518091039020908051906020019062000b6492919062000b6b565b5062000c21565b828054600181600116156101000203166002900490600052602060002090601f01602090048101928262000ba3576000855562000bef565b82601f1062000bbe57805160ff191683800117855562000bef565b8280016001018555821562000bef579182015b8281111562000bee57825182559160200191906001019062000bd1565b5b50905062000bfe919062000c02565b5090565b5b8082111562000c1d57600081600090555060010162000c03565b5090565b61125f8062000c316000396000f3fe608060405234801561001057600080fd5b50600436106100a95760003560e01c8063a19909bc11610071578063a19909bc146102a2578063a3e68bfa146103d6578063d423740b146103f6578063daa389de1461044e578063f2fde38b14610492578063f6b4c2d0146104d6576100a9565b806355c1c7e8146100ae578063715018a6146100f25780638da5cb5b146100fc5780638f32d59b146101305780639c549c4914610150575b600080fd5b6100f0600480360360208110156100c457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061060a565b005b6100fa6107d8565b005b6101046108a7565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6101386108d0565b60405180821515815260200191505060405180910390f35b6102a06004803603604081101561016657600080fd5b810190808035906020019064010000000081111561018357600080fd5b82018360208201111561019557600080fd5b803590602001918460018302840111640100000000831117156101b757600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561021a57600080fd5b82018360208201111561022c57600080fd5b8035906020019184600183028401116401000000008311171561024e57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610927565b005b61035b600480360360208110156102b857600080fd5b81019080803590602001906401000000008111156102d557600080fd5b8201836020820111156102e757600080fd5b8035906020019184600183028401116401000000008311171561030957600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610bb1565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561039b578082015181840152602081019050610380565b50505050905090810190601f1680156103c85780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6103de610cbc565b60405180821515815260200191505060405180910390f35b6104226004803603602081101561040c57600080fd5b8101908080359060200190929190505050610d5c565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6104906004803603602081101561046457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610d9b565b005b6104d4600480360360208110156104a857600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610f92565b005b61058f600480360360208110156104ec57600080fd5b810190808035906020019064010000000081111561050957600080fd5b82018360208201111561051b57600080fd5b8035906020019184600183028401116401000000008311171561053d57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610faf565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156105cf5780820151818401526020810190506105b4565b50505050905090810190601f1680156105fc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6106126108d0565b61061b57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614156106be576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f64656c736574746572207061726120657272000000000000000000000000000081525060200191505060405180910390fd5b60005b6002805490508110156107d3578173ffffffffffffffffffffffffffffffffffffffff16600282815481106106f257fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156107c6576002818154811061074657fe5b9060005260206000200160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690557f82ebf361cdb2193d0621e2b445a01e372b81d60de1dd468a29c537cbc199e14882604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a1506107d5565b80806001019150506106c1565b505b50565b6107e06108d0565b6107e957600080fd5b600073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a360008060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614905090565b61092f610cbc565b61093857600080fd5b60008251116109af576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f7365746b6579206b206572726f7200000000000000000000000000000000000081525060200191505060405180910390fd5b6000815111610a26576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f7365746b65792076206572726f7200000000000000000000000000000000000081525060200191505060405180910390fd5b806001836040518082805190602001908083835b60208310610a5d5780518252602082019150602081019050602083039250610a3a565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390209080519060200190610aa392919061116c565b507fc70190ccf4386b5b53a796ed5a973f4ded4b746d717110d2c1a661fa5355a8e38282604051808060200180602001838103835285818151815260200191508051906020019080838360005b83811015610b0b578082015181840152602081019050610af0565b50505050905090810190601f168015610b385780820380516001836020036101000a031916815260200191505b50838103825284818151815260200191508051906020019080838360005b83811015610b71578082015181840152602081019050610b56565b50505050905090810190601f168015610b9e5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a15050565b60606001826040518082805190602001908083835b60208310610be95780518252602082019150602081019050602083039250610bc6565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390208054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610cb05780601f10610c8557610100808354040283529160200191610cb0565b820191906000526020600020905b815481529060010190602001808311610c9357829003601f168201915b50505050509050919050565b600080600090505b600280549050811015610d53573373ffffffffffffffffffffffffffffffffffffffff1660028281548110610cf557fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610d46576001915050610d59565b8080600101915050610cc4565b50600090505b90565b60028181548110610d6c57600080fd5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b610da36108d0565b610dac57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415610e4f576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f616464736574746572207061726120657272000000000000000000000000000081525060200191505060405180910390fd5b60005b600280549050811015610edd578173ffffffffffffffffffffffffffffffffffffffff1660028281548110610e8357fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610ed05750610f8f565b8080600101915050610e52565b506002819080600181540180825580915050600190039060005260206000200160009091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507fd6c68344753d7b3b35f2deb4103f05c7ba6e02db4e501fabdfffeb8794da9c0781604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a15b50565b610f9a6108d0565b610fa357600080fd5b610fac81611075565b50565b6001818051602081018201805184825260208301602085012081835280955050505050506000915090508054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561106d5780601f106110425761010080835404028352916020019161106d565b820191906000526020600020905b81548152906001019060200180831161105057829003601f168201915b505050505081565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614156110af57600080fd5b8073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b828054600181600116156101000203166002900490600052602060002090601f0160209004810192826111a257600085556111e9565b82601f106111bb57805160ff19168380011785556111e9565b828001600101855582156111e9579182015b828111156111e85782518255916020019190600101906111cd565b5b5090506111f691906111fa565b5090565b5b808211156112135760008160009055506001016111fb565b509056fea26469706673582212207e4f576259738773e4477d336e2e120142f2bdc76c0986c2f497d8eb87e0eb5f64736f6c6375302e372e352b636f6d6d69742e656237376564303800456231646661633730353234363763636637396637383730663261613361353134656666636262306461376535393831393435623338363531326465316664396464373062616538343062313361616334613630383362353835323238383235653762653165306561313434373436353938653432636133343032373963383033396532643133633036366633336666333062623937633233313335306332633364343136396664396437336431666431616366326436353064646562613737383532656438666262386631313737616337313764346362336565636664333833313762393339636539386138353866316463306535646162636166396265393633366236613234656337346436646335333234393661616138336232643966373139316165646235393530373361393962616135353234303933633736323966346233396361323065366331613137663839346531386535653434666137656134613731373762623430333863326263626261623431336537333334393462626165343161653730656330353937393162326535303866333936303538623965366132633538313431376637613466353933333234363066303861323536356564303537313832613165333461336563653761623936323262313331343732313034633466626564333063363732303132353731383437626261323831623235636136373861656163636130636161646632343732386437643338323164343166663733366461303761643166313365313835643362383739366461343532363538356366383637323330633461356664616462663331653734376234376231316238346537363263333265313232653030393761383432313134316565656363306534666362656165373333643965626632333964323866323262333163663964313039363462636461303835623237613233353061613530636634306234316563623434313734396632663339643036336636633763366632383061383038623764633230383763313266636533656562393637303761626330633261396336303838386330323033653561326661303031623462626238316361366165356533326337303031323534383462346538663230653539613365623563653265636664616531383764353436613934643237663235376635646461336164343735613334343339626664633136323430363662626130303731653733383130363433346664623034346535336161323732386637666366393837383137383430613332383933373734623062623465633033636664616430636131316265323064343863383431306435613363343863623366303761346566616261626163336131383637353564366162633730373030613363366238386538323366626339373335363131376137396332376535346238386132333763613661316364336533356564343233646434616263623139353732373437323334363138333130353936306165323832383038316432373663653131623838333961373232623961303132393930653638616361323038356466613463613230333732643662313166346435306133643461633339373736633337316361393564383836343662363566616635373363643837633036633039613131663333303939366239663562343430313463333639303239613031313832616130303634616335396531343932623666326230306639653038303532333464306661323737326138396431626534396130393561363837313534363561333762613566393162613633636262333731393438383864373732343230373830316134633463316432613135646662353061323339633666323739653837633366336164386466373864626337303439313066646563663234636435336236313865626361336535303034636265346431653264656239396434623332663835383363656635316634323839333737636135323637663462303032653863326439386338313135613465633934343739393033326164613962363333623664333130343364636436613761383461336437653631346638363164646364356131323834633833333138613561316663356534666262633733366661323534366237626533633966666565313930653339363064303035343161336237616462623933643237666634656136336337363036396636666161393031633761643162353266653433613836616664353462643838366637363261666130343539626334373065646538643964653064346537373466376436313739323435646332326366323739323638373631323930383931663831636461373238363833323733623139356436363463333738303331613934623434333034666464373763613331383732613736353664396339633861376232393631313762633336333634616336353361336666633866363138643734633537653663323733363036306236363763373162666130626565633836663133623839653239353032663533373130316465366166336463316139653165333164313439306464643733393530396436633565643766616563666564313339323636356633313239333963336630333134373030633266323265333864353464336635376334323331303162666661376238303766386339653065323631396538656366363364316166616532326165363236393132366138613961633362366563626438313736663830363566323735363838613535393865306463386237376135333431383733633530323463326431633066336536323864643539313166366534376638346462336236346333363438656262356131323761316263306630393337343839633830366331393434666430323964633937313539303738316466313134656330373265363431636463356432323435313334646333393636633865393134303236363961343763633835393730613238316632363861343462323161346637376139316135326639363036613330633966323264326535636236393334323633643038333838303931633536616331646662663162656561333165386136313363326135316635353064363935613531346433386234356338363233323061303065613533393431396134333364366266646431393738333536636263613462363030613537306665353832393138633466373331613030303230363864663238623261313933303839653662663935316335353362356136663731616161646363363636396466613334366633323237313738353161386332326133323430343161663837333665383764653433353838363066666630353762656666336631393034366134336164636534366339333235313439383861666531333039663837343134626433366564323936646163666164653265306361663033323335653931613264623237653965643231346263633665356366393935623565663539636539393433643166343230396236616262643663613462366232306266303333626666393431616633316262666237306637376635653838323936656365653938313563336363626439356433626130303033323638336366613238633433363566646365633536663533316632386365656531623732636363303061663437353535346163386366613636653461313764613465346265653562313133393061663436376438303634613962626263366239643933396165376366626661343838356464393739336630633533653936623966393332396235613837356262313236346634346466333364313136333963373966363337373334396339353739343463386466363631313937363633613232393362306533666130336262643063356634623236626438653065346466333537356633346462636665633739643637613333306362306163383833326235653962373133613132303162383436303765626232343337626466313038313764373861303762633633333635333365373738396666643235626333303564336461643838376462323965313962316135386232323065393364663864633963653536656461656331393131383230633966343933653963353135393938613662373366393461376630363532623334666162303230616230363238356266633138623761353938383430343165313438626662656262386265353130396366623035323065346164373863346164623064656235653630353136326236343639333439666331666465393236396238386435393665643966333733356330306335393233313763393832333230383734623938376263633338653835353661633534346264656531363962363661653866653633393832386666356166623466313939303137653364386536373561303737663231636439653563353236633138363634373665376261373463643762623136613163336439336263376262316435373661656462343330376336623934386435623863323966373933303737383864376138656266383435383562663533393934383237633233613561626332373135343133306231643934363364353662633833313231633061353136333730656236383466633438383538393165383833303039343361626431383039656235373264326430643063383133343364343666336564356663623934373062326334336430653037636437626261633839623063356136643637643663343964346234613661336630663331316433383733383933353038386666653763336233316439383662626534376438343462633137383634353030323639663538653433623865386132333066653964613531616639386634396564666530313530666535663236393736373862633931393336346131353430613761316362343035353463383738643230643365636139633462316138386430663661643562303362663238616332353430303766383463393137653631643230373037633935343730316432376461303366316339666433363332326539666631303732643232333038343263353739386232363536383937386430303562356331396530663636393131396231646134626233336136393331346666616139333837663662396334373164663537333230623136656565373430383335356635336537373832363432303333343131343338393566386332323936383331353732316664373536633661313264336361303130353038623233643738313764336139663439613532656334333931333633633038396564356338323335656536323665633238366665383439613135393837616636383736316366613532313362343138383231663335653634316464363032653039366631356530373066643236333539333938646431643535393361373534306431663064343232326665633431663566343464353835346237653933616262306233336334666434323366663866633536383466636366396566303031616638383162343163616465623363373965663563383034333066313433613563393338336262353062333439333731316634643337333966373236383735326265633433316232613866353961363634303831393663646636386266356337626535363131646361643334663332626461663139666331663766346633656566663362383333623938616638626166316163636336343663666336616133643362636330313734373164393662353862646466356233653338393764396662363137323035306663383664613535323436313232633463623937336561303237643639666166386530653635366366663664316632626164373064343264326565646633386363643862323033613339613964386161313333646334303161373231646633316235363663633231396562396565353532353662653336613864306135663531383439633339393939643964306361643337303565356234613234336162343062393435373831386431663237663262323130316530333032313230316266393462343039336438336532653965323138633362623132656531636164313030656630346432623534646462623432633665316231333864613138663738306465613132636637636461393033353536656263313936396234396335616530323632653834616464323061666265356364313166393038376438666431383130383166323136396437353031623237303139623236383430393265656636326230633863376338303933653339393566393139353136666535356537666130316462626461356265323363363036346531393037616531343764326139366338303839633735316565356131643837326235613762653131383435303536643238333834636662353939373863346139316234666665393064336465633036313662333932363033386632376461346534643235346338633132383362633964636461626561633530306662663065383962393864313035396137616138333238393362303863396535316663656134373661363935313162653631313235306139316236613132303461323235363162623837623739663139383561363837383531313834353333643933646661623938366663326330323833306337623132646639636630653332353965303638623937346533663663663939666136333734346338623562323336323961346566616434323566613262323962333632323434333337336434633338393338396563656363353639326530663135623534623966343962393939666430373534646234316134666331366238323336663638353535663935343633313133323665353663316561316665383538653363363666336131323832643434306533623438373537396464326331393863386231356135626162383266313531366634386334303133303633333139633461303637383966393433633566633465373736386332633064346365383731633363353161313737626138356165376530366436633339663063373333353036366363626635656661343561633564363436333863393130396137663065333839666337316138343361373561393532333136383862366133663038333163316332643563623962323731646130636532303066343037353466623435363161636232326330653161633839353132333634643734666565613966303732383934663261383866303834653039343835616539633566393631333038323935653162623765383335623837633362633062636530623832376638363030613131653937633534323931623030613037626138313762333365626661366363363766356635316265626532353837393031393738353166383039343361336263313735373234323861613139653461613934393039316639613433366161366530623365313737336539636132303134343166303761313034636365303335323863336431353839316139636530336564326138626134306463343265323934633364313830626135656534343838633834373232636561616462363934323864326336303236636634376135393261343637636338623135613733656133373533643766363135653531386261363134333930653663333739366561333733363763346631613130393634366435343732653965323865386434396538343932346536343830383765646535393664323236636232303936326630383133663066373731393262666661353262356566383636386134656565323935636534343665633866363833656462623761643233373330323366663332363764343463316261373932333831663638646265653364313734333164623365313166353231353133663132363434346130636331333463623730326264363933663761303030626539663063366235376632623637656132343632646530656638356339393239623933376264356635386536363838326238326239643233653038363438333138363032633864653439396539623132383762363638326133663264643365323265326635")
	createResult, contractAddress, createLeftGas, createErr := mockCreate(contractCodeBytes, config)
	fmt.Printf("New create contract address:%s\n", contractAddress.GetHexString())
	fmt.Printf("New create contract createResult:%v\n", createResult)
	fmt.Printf("New create contract createLeftGas:%v,createErr:%v\n", createLeftGas, createErr)

	root, err := config.State.Commit(true)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	trieDB := config.AccountDatabase.TrieDB()
	err = trieDB.Commit(root, false)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	db, err := account.NewAccountDB(root, config.AccountDatabase)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	bytes := common.FromHex("0x582d4d61696c67756e2d496e636f6d696e673a205965730d0a582d456e76656c6f70652d46726f6d3a203c63727970746f77656233406f75746c6f6f6b2e636f6d3e0d0a52656365697665643a2066726f6d2045555230332d4442352d6f62652e6f7574626f756e642e70726f74656374696f6e2e6f75746c6f6f6b2e636f6d20286d61696c2d6f6c6e3034303039323037313036342e6f7574626f756e642e70726f74656374696f6e2e6f75746c6f6f6b2e636f6d205b34302e39322e37312e36345d290a206279206d78612e6d61696c67756e2e6f726720776974682045534d54502069642036316261376563382e3766653462383835643239382d736d74702d696e2d6e30333b0a205765642c2031352044656320323032312032333a34383a3234202d303030302028555443290d0a4152432d5365616c3a20693d313b20613d7273612d7368613235363b20733d61726373656c6563746f72393930313b20643d6d6963726f736f66742e636f6d3b2063763d6e6f6e653b0d0a20623d56456b44534e5a5a4863525378653139562f636c6a68396438727653726948416b43594638436f505477536f57437634774e45376f3551314b7077536f416a314d515a384f7146336a4a5a734758513468465967316434754c70584e7258757132364f6731796c4966762b634e796a2f6f504770446f546164614439486571544f4c526f6e51494e5a78422f764a75474e5a364d49595135713243793536592b7a62686773484a58517844676a5747616f47755969594a71436c5963396b36314666574539737934384e746d6769424d334a4b784b704954496b347648452b755845574d4e4c5a4d4356584f4d466258435037322f672f4d3361504d45666d67534d6a5169686b44714a4e2f4946546f2b463464466a5a5a4d553253434e45776e30394a553875364374615045786c746f4e576c4153646e65564b51672f506d394c754638627666753672626177473166786b3846513d3d0d0a4152432d4d6573736167652d5369676e61747572653a20693d313b20613d7273612d7368613235363b20633d72656c617865642f72656c617865643b20643d6d6963726f736f66742e636f6d3b0d0a20733d61726373656c6563746f72393930313b0d0a20683d46726f6d3a446174653a5375626a6563743a4d6573736167652d49443a436f6e74656e742d547970653a4d494d452d56657273696f6e3a582d4d532d45786368616e67652d416e74695370616d2d4d657373616765446174612d4368756e6b436f756e743a582d4d532d45786368616e67652d416e74695370616d2d4d657373616765446174612d303a582d4d532d45786368616e67652d416e74695370616d2d4d657373616765446174612d313b0d0a2062683d42526d686b6879525a35554444446c7851533471737351744177386a4a426c336c674d47474c57767a54493d3b0d0a20623d4f66706c5033725145424a5a714e30454870617269736a4a687531727554375374316e356b51626777553734706e4e78587446512b554977686375653479686d6175564f42395375514a4958417435635577674d53374537426b4a79447a63503337417239744a396e4e2b6275796f6165593946502b774a4d4a2f4b6665326c4a5246673946774b57726a5a6a78624844636b445635514b59534b6c677455496a53723874537a38484456337155506d41343543625053636465437a6738325a6f435234624a6e476e71694a487349567043736874366a57626e46466550316e574c4c3968576a42795062566441503550416d744a3767627466494636554d6448776d7454556d6b374c6244657a527934505472444b435856444d584b6a744b673735565a3567596370476b6f336e4d33356765437249524e654b2b766236333337714d304e624c33325457317363474351596669673d3d0d0a4152432d41757468656e7469636174696f6e2d526573756c74733a20693d313b206d782e6d6963726f736f66742e636f6d20313b207370663d6e6f6e653b20646d6172633d6e6f6e653b0d0a20646b696d3d6e6f6e653b206172633d6e6f6e650d0a444b494d2d5369676e61747572653a20763d313b20613d7273612d7368613235363b20633d72656c617865642f72656c617865643b20643d6f75746c6f6f6b2e636f6d3b0d0a20733d73656c6563746f72313b0d0a20683d46726f6d3a446174653a5375626a6563743a4d6573736167652d49443a436f6e74656e742d547970653a4d494d452d56657273696f6e3a582d4d532d45786368616e67652d53656e6465724144436865636b3b0d0a2062683d42526d686b6879525a35554444446c7851533471737351744177386a4a426c336c674d47474c57767a54493d3b0d0a20623d626653364977573868694e662b4135664f4a687750766f3974726651326c4c4f535647507464494339704d6d41394658464854456b575a317645314f742f4236416b4c346e4a7164342b373578675369693055376444594e76336d36516675365832706b41305a652b62775259584f6c644f66696d2f4d4974714b516f30726b4d576958737965447247674f4a543074724a714b6a7938345362726d347172485772537231685253544b39726c686356726d657236456a4436712b6668443351646c6d3479786c7a323544655a38795056546b353739787a486e49367a50654e3530354a452b7374346b4431634d4e4a41356d356d492f2b344d627031706f354270564474654e5479544e6f6e4435307045426d51414e416743774e6e416775724a6459346e397533696c774f733638345a455658584d7844747732757535487a453851793741464e4a582f352f7074394c463976673d3d0d0a52656365697665643a2066726f6d20505232505230394d42333134352e65757270726430392e70726f642e6f75746c6f6f6b2e636f6d2028323630333a313061363a3130313a31383a3a3136290d0a20627920504158505230394d42353038372e65757270726430392e70726f642e6f75746c6f6f6b2e636f6d2028323630333a313061363a3130323a3133633a3a362920776974680d0a204d6963726f736f667420534d545020536572766572202876657273696f6e3d544c53315f322c0d0a206369706865723d544c535f45434448455f5253415f574954485f4145535f3235365f47434d5f534841333834292069642031352e32302e343737382e31373b205765642c203135204465630d0a20323032312032333a34383a3137202b303030300d0a52656365697665643a2066726f6d20505232505230394d42333134352e65757270726430392e70726f642e6f75746c6f6f6b2e636f6d0d0a20285b666538303a3a313965333a313137323a653839343a613933625d2920627920505232505230394d42333134352e65757270726430392e70726f642e6f75746c6f6f6b2e636f6d0d0a20285b666538303a3a313965333a313137323a653839343a6139336225375d292077697468206d6170692069642031352e32302e343737382e3031373b205765642c2031352044656320323032310d0a2032333a34383a3137202b303030300d0a582d51512d4d494d453a2054434d696d6520312e302062792054656e63656e740d0a582d4d61696c65723a2051514d61696c20322e780d0a582d51512d4d61696c65723a2051514d61696c20322e780d0a4d6573736167652d49443a0d0a203c505232505230394d42333134353034414631393838423941433531303346373144394337363940505232505230394d42333134352e65757270726430392e70726f642e6f75746c6f6f6b2e636f6d3e0d0a5375626a6563743a2055503078326664663363396463313934393038316236373837643931353939643239666131643932613062393066316332363637386539366239366165373339613932620d0a446174653a205468752c2031362044656320323032312030373a34383a3035202b303830302028474d542b30383a3030290d0a46726f6d3a203d3f5554462d383f423f59334a3563485276643256694d30427664585273623239724c6d4e7662513d3d3f3d3c63727970746f77656233406f75746c6f6f6b2e636f6d3e0d0a546f3a203d3f5554462d383f423f3f3d3c626f74406d61696c2e756e69706173732e69643e0d0a436f6e74656e742d547970653a206d756c7469706172742f616c7465726e61746976653b200d0a09626f756e646172793d222d2d2d2d3d5f506172745f305f373231303134332e31363339363132303931303932220d0a582d544d4e3a0d0a205b6c65316b68644c2b544d5a5a4b6c71436b46554c64776b6b324a4b4e41354d6e32517a417830326634743255514d61394156694b3763376c554b684135483273476c6f504741352b55554d3d5d0d0a582d436c69656e7450726f7869656442793a20534732505230344341303137352e61706370726430342e70726f642e6f75746c6f6f6b2e636f6d0d0a2028323630333a313039363a343a31343a3a31332920546f20505232505230394d42333134352e65757270726430392e70726f642e6f75746c6f6f6b2e636f6d0d0a2028323630333a313061363a3130313a31383a3a3136290d0a52657475726e2d506174683a2063727970746f77656233406f75746c6f6f6b2e636f6d0d0a582d4d6963726f736f66742d4f726967696e616c2d4d6573736167652d49443a2074656e63656e745f3934384536453935383130353439454143413638313830364071712e636f6d0d0a4d494d452d56657273696f6e3a20312e300d0a582d4d532d45786368616e67652d4d65737361676553656e74526570726573656e74696e67547970653a20310d0a582d4d532d5075626c696354726166666963547970653a20456d61696c0d0a582d4d532d4f66666963653336352d46696c746572696e672d436f7272656c6174696f6e2d49643a2039333466613539652d343732352d346131632d336466372d3038643963303235356165630d0a582d4d532d5472616666696354797065446961676e6f737469633a20504158505230394d42353038373a45455f0d0a582d4d6963726f736f66742d416e74697370616d3a2042434c3a303b0d0a582d4d6963726f736f66742d416e74697370616d2d4d6573736167652d496e666f3a0d0a097848506f674d317a34694e7a6b55482b58534753336f51675a414e34626941394635634d6555785a6b4e334a7a6e325a6b77347546794763704c4279365a564c7973433674357867706b72634a524e527a7066516c563368454d2f2f2f3477507263716b6257776e686e305778424b684643434f744279336c4b59335973444736777057536f7a624f696449764e753531533052726d2b374b552f536e356d672f4e2f746847506d657757644467694639584f654271546f597135573348457a71796b664c6941775636467439373162504572353031624232646f7a636e5a706d5947584a7a3057516f7063655649772f36566b38522f766f6f427a6e744579655a6b694145453339444c764b614e4d663051506d476d575969656945717a754b526561546446396d67354643733557483455594b38394943626a6a414750660d0a582d4d532d45786368616e67652d416e74695370616d2d4d657373616765446174612d4368756e6b436f756e743a20310d0a582d4d532d45786368616e67652d416e74695370616d2d4d657373616765446174612d303a0d0a093d3f75732d61736369693f513f42316b68364b546c623864492b48316c3157716b6f77777462634d4e73564a754c364e4e54377743376c6b3731687a6555786c6c352b335a6f65684a3f3d0d0a203d3f75732d61736369693f513f616f52597648584a7a6b374345653741322b334472613343724f774578644c754e7173477855654d64726d6d2b486e48534e434f5852504f3634754a3f3d0d0a203d3f75732d61736369693f513f626b582b4d6e717338494b5463614a63316d61394578772b38714b696b3574686a742b6b344c45385367774b52565538555942755068443632686c443f3d0d0a203d3f75732d61736369693f513f784b506335384670414351467866316c4544777673482f49636269576b2f68632b534b467355345443546773662b7041345456775854387364436f563f3d0d0a203d3f75732d61736369693f513f7045596c697742384e6c6332304d6939554854475749307446652b536e396d7571766a4a52426a45306e6d6631564e7449384b556d7233304d456a4f3f3d0d0a203d3f75732d61736369693f513f4e67516d39734d586c46746254527238634d7838454f6b31557057536d705657487a453877487377496a6f2f633970565531444a325a57373439504a3f3d0d0a203d3f75732d61736369693f513f6a546f624646473150446b4e5a456b507733674c5a352b6b706a393056684a2b683152303567797a6b325235354759655055477248525167625167533f3d0d0a203d3f75732d61736369693f513f42464c6d5336747330506936356237726478424c484963636330682b6e2b56744775417a78526963784e4f5a4f5a6d4152456569473438736a6642333f3d0d0a203d3f75732d61736369693f513f583263733256494849492b56626a683757346a70783933616748342b4846522b50777065495136654c585547594338556f746f6c7554592f713133353f3d0d0a203d3f75732d61736369693f513f7844714b4e78554f532b6a4d732b48786f5453456f687733617548676e35374e44322f7a494d2f583271444848617055537475507545684a4873504f3f3d0d0a203d3f75732d61736369693f513f44315766776364724e4a334c686172336a59484141382b49386d547858472f645632744d6837674c526231482f2f684967726c394d666a7065654f353f3d0d0a203d3f75732d61736369693f513f494c53427467336634742f6969654473664e4e573463782b463079383872685259583851556767794c747a6c3852536742736e316477734b557246483f3d0d0a203d3f75732d61736369693f513f576d3632364834582b644938376b7655747848473535722b58504f7833564a6d5a324d6865534548495256556e3439644172317a744870694873366f3f3d0d0a203d3f75732d61736369693f513f7a304e4b4732474b5453673042466a4c566e54754564446547467278365a38784d6f494b7044707a45655433676750436f7955476e69345050774a483f3d0d0a203d3f75732d61736369693f513f557762635473742b48527a6c44554a794c38677633564f754d7276396a51374769515761714646364767357748413069705279505047495968696b7a3f3d0d0a203d3f75732d61736369693f513f4b34786b4238316f5175386a2b6656745248534a7977444b746a5a6872734e6d6d386f687754724a44387a62676143684762493746797042497642423f3d0d0a203d3f75732d61736369693f513f594d7031423156495042323252554d3645762b65712b6669782b626f444751796c3677316a47413574564533356e76524841456d58614c4e32582b723f3d0d0a203d3f75732d61736369693f513f5a62616c36777771434e59784c5161427039305a5050526374513d33443d33443f3d0d0a582d4f726967696e61746f724f72673a206f75746c6f6f6b2e636f6d0d0a582d4d532d45786368616e67652d43726f737354656e616e742d4e6574776f726b2d4d6573736167652d49643a2039333466613539652d343732352d346131632d336466372d3038643963303235356165630d0a582d4d532d45786368616e67652d43726f737354656e616e742d41757468536f757263653a20505232505230394d42333134352e65757270726430392e70726f642e6f75746c6f6f6b2e636f6d0d0a582d4d532d45786368616e67652d43726f737354656e616e742d4175746841733a20496e7465726e616c0d0a582d4d532d45786368616e67652d43726f737354656e616e742d4f726967696e616c4172726976616c54696d653a2031352044656320323032312032333a34383a31372e333337300d0a2028555443290d0a582d4d532d45786368616e67652d43726f737354656e616e742d46726f6d456e746974794865616465723a20486f737465640d0a582d4d532d45786368616e67652d43726f737354656e616e742d49643a2038346466396537662d653966362d343061662d623433352d6161616161616161616161610d0a582d4d532d45786368616e67652d43726f737354656e616e742d524d532d506572736973746564436f6e73756d65724f72673a0d0a0930303030303030302d303030302d303030302d303030302d3030303030303030303030300d0a582d4d532d45786368616e67652d5472616e73706f72742d43726f737354656e616e74486561646572735374616d7065643a20504158505230394d42353038370d0a0d0a20556e69706173732054657374")
	res := dkim.Verify(bytes, contractAddress, db)
	fmt.Println(common.ToHex(res))
	fmt.Println(len(res))
}

func TestVerify(t *testing.T) {
	os.RemoveAll("storage0")
	os.RemoveAll("1.ini")
	mockInit()
	config := new(testConfig)
	setDefaults(config)
	defer log.Close()

	config.GasLimit = 3000000
	config.GasPrice = big.NewInt(0)

	contractCodeBytes := common.Hex2Bytes("60806040523480156200001157600080fd5b50336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a36040518061022001604052806102008152602001620030906102009139600160405180807f323031363130323540676d61696c2e636f6d00000000000000000000000000008152506012019050908152602001604051809103902090805190602001906200013d92919062000b6b565b506040518061022001604052806102008152602001620030906102009139600160405180807f323031363130323540676f6f676c656d61696c2e636f6d000000000000000000815250601701905090815260200160405180910390209080519060200190620001ae92919062000b6b565b50604051806101200160405280610100815260200162002a906101009139600160405180807f733230313531324071712e636f6d000000000000000000000000000000000000815250600e019050908152602001604051809103902090805190602001906200021f92919062000b6b565b50604051806101200160405280610100815260200162002a906101009139600160405180807f7332303135313240666f786d61696c2e636f6d000000000000000000000000008152506013019050908152602001604051809103902090805190602001906200029092919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237403136332e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200030192919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237403132362e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200037292919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f7331313035323740796561682e6e657400000000000000000000000000000000815250601001905090815260200160405180910390209080519060200190620003e392919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237403138382e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200045492919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237407669702e3136332e636f6d00000000000000000000000000815250601301905090815260200160405180910390209080519060200190620004c592919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237407669702e3132362e636f6d000000000000000000000000008152506013019050908152602001604051809103902090805190602001906200053692919062000b6b565b50604051806101200160405280610100815260200162002d906101009139600160405180807f73313130353237407669702e3138382e636f6d00000000000000000000000000815250601301905090815260200160405180910390209080519060200190620005a792919062000b6b565b506040518061022001604052806102008152602001620032906102009139600160405180807f7332303438407961686f6f2e636f6d0000000000000000000000000000000000815250600f019050908152602001604051809103902090805190602001906200061892919062000b6b565b506040518061012001604052806101008152602001620034906101009139600160405180807f646264356166326362616637406d61696c2e636f6d00000000000000000000008152506015019050908152602001604051809103902090805190602001906200068992919062000b6b565b506040518061022001604052806102008152602001620028906102009139600160405180807f73656c6563746f7231406f75746c6f6f6b2e636f6d0000000000000000000000815250601501905090815260200160405180910390209080519060200190620006fa92919062000b6b565b506040518061022001604052806102008152602001620028906102009139600160405180807f73656c6563746f723140686f746d61696c2e636f6d00000000000000000000008152506015019050908152602001604051809103902090805190602001906200076b92919062000b6b565b50604051806102200160405280610200815260200162002b906102009139600160405180807f323032313031313240676d61696c2e636f6d0000000000000000000000000000815250601201905090815260200160405180910390209080519060200190620007dc92919062000b6b565b50604051806102200160405280610200815260200162002b906102009139600160405180807f323032313031313240676f6f676c656d61696c2e636f6d0000000000000000008152506017019050908152602001604051809103902090805190602001906200084d92919062000b6b565b506040518061012001604052806101008152602001620020906101009139600160405180807f70726f746f6e6d61696c4070726f746f6e6d61696c2e636f6d00000000000000815250601901905090815260200160405180910390209080519060200190620008be92919062000b6b565b506040518061022001604052806102008152602001620023906102009139600160405180807f736d7470406d61696c2e756e69706173732e6d650000000000000000000000008152506014019050908152602001604051809103902090805190602001906200092f92919062000b6b565b506040518061012001604052806101008152602001620025906101009139600160405180807f65746840756e69706173732e6964000000000000000000000000000000000000815250600e01905090815260200160405180910390209080519060200190620009a092919062000b6b565b50604051806102200160405280610200815260200162002e906102009139600160405180807f70726f746f6e6d61696c40706d2e6d650000000000000000000000000000000081525060100190509081526020016040518091039020908051906020019062000a1192919062000b6b565b506040518061022001604052806102008152602001620026906102009139600160405180807f3161316861694069636c6f75642e636f6d00000000000000000000000000000081525060110190509081526020016040518091039020908051906020019062000a8292919062000b6b565b506040518061022001604052806102008152602001620021906102009139600160405180807f70726f746f6e6d61696c324070726f746f6e6d61696c2e636f6d000000000000815250601a0190509081526020016040518091039020908051906020019062000af392919062000b6b565b50604051806102200160405280610200815260200162001e906102009139600160405180807f70726f746f6e6d61696c3240706d2e6d6500000000000000000000000000000081525060110190509081526020016040518091039020908051906020019062000b6492919062000b6b565b5062000c21565b828054600181600116156101000203166002900490600052602060002090601f01602090048101928262000ba3576000855562000bef565b82601f1062000bbe57805160ff191683800117855562000bef565b8280016001018555821562000bef579182015b8281111562000bee57825182559160200191906001019062000bd1565b5b50905062000bfe919062000c02565b5090565b5b8082111562000c1d57600081600090555060010162000c03565b5090565b61125f8062000c316000396000f3fe608060405234801561001057600080fd5b50600436106100a95760003560e01c8063a19909bc11610071578063a19909bc146102a2578063a3e68bfa146103d6578063d423740b146103f6578063daa389de1461044e578063f2fde38b14610492578063f6b4c2d0146104d6576100a9565b806355c1c7e8146100ae578063715018a6146100f25780638da5cb5b146100fc5780638f32d59b146101305780639c549c4914610150575b600080fd5b6100f0600480360360208110156100c457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061060a565b005b6100fa6107d8565b005b6101046108a7565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6101386108d0565b60405180821515815260200191505060405180910390f35b6102a06004803603604081101561016657600080fd5b810190808035906020019064010000000081111561018357600080fd5b82018360208201111561019557600080fd5b803590602001918460018302840111640100000000831117156101b757600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561021a57600080fd5b82018360208201111561022c57600080fd5b8035906020019184600183028401116401000000008311171561024e57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610927565b005b61035b600480360360208110156102b857600080fd5b81019080803590602001906401000000008111156102d557600080fd5b8201836020820111156102e757600080fd5b8035906020019184600183028401116401000000008311171561030957600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610bb1565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561039b578082015181840152602081019050610380565b50505050905090810190601f1680156103c85780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6103de610cbc565b60405180821515815260200191505060405180910390f35b6104226004803603602081101561040c57600080fd5b8101908080359060200190929190505050610d5c565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6104906004803603602081101561046457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610d9b565b005b6104d4600480360360208110156104a857600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610f92565b005b61058f600480360360208110156104ec57600080fd5b810190808035906020019064010000000081111561050957600080fd5b82018360208201111561051b57600080fd5b8035906020019184600183028401116401000000008311171561053d57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610faf565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156105cf5780820151818401526020810190506105b4565b50505050905090810190601f1680156105fc5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6106126108d0565b61061b57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614156106be576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f64656c736574746572207061726120657272000000000000000000000000000081525060200191505060405180910390fd5b60005b6002805490508110156107d3578173ffffffffffffffffffffffffffffffffffffffff16600282815481106106f257fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156107c6576002818154811061074657fe5b9060005260206000200160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690557f82ebf361cdb2193d0621e2b445a01e372b81d60de1dd468a29c537cbc199e14882604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a1506107d5565b80806001019150506106c1565b505b50565b6107e06108d0565b6107e957600080fd5b600073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a360008060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614905090565b61092f610cbc565b61093857600080fd5b60008251116109af576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f7365746b6579206b206572726f7200000000000000000000000000000000000081525060200191505060405180910390fd5b6000815111610a26576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f7365746b65792076206572726f7200000000000000000000000000000000000081525060200191505060405180910390fd5b806001836040518082805190602001908083835b60208310610a5d5780518252602082019150602081019050602083039250610a3a565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390209080519060200190610aa392919061116c565b507fc70190ccf4386b5b53a796ed5a973f4ded4b746d717110d2c1a661fa5355a8e38282604051808060200180602001838103835285818151815260200191508051906020019080838360005b83811015610b0b578082015181840152602081019050610af0565b50505050905090810190601f168015610b385780820380516001836020036101000a031916815260200191505b50838103825284818151815260200191508051906020019080838360005b83811015610b71578082015181840152602081019050610b56565b50505050905090810190601f168015610b9e5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a15050565b60606001826040518082805190602001908083835b60208310610be95780518252602082019150602081019050602083039250610bc6565b6001836020036101000a03801982511681845116808217855250505050505090500191505090815260200160405180910390208054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610cb05780601f10610c8557610100808354040283529160200191610cb0565b820191906000526020600020905b815481529060010190602001808311610c9357829003601f168201915b50505050509050919050565b600080600090505b600280549050811015610d53573373ffffffffffffffffffffffffffffffffffffffff1660028281548110610cf557fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610d46576001915050610d59565b8080600101915050610cc4565b50600090505b90565b60028181548110610d6c57600080fd5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b610da36108d0565b610dac57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415610e4f576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f616464736574746572207061726120657272000000000000000000000000000081525060200191505060405180910390fd5b60005b600280549050811015610edd578173ffffffffffffffffffffffffffffffffffffffff1660028281548110610e8357fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610ed05750610f8f565b8080600101915050610e52565b506002819080600181540180825580915050600190039060005260206000200160009091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507fd6c68344753d7b3b35f2deb4103f05c7ba6e02db4e501fabdfffeb8794da9c0781604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a15b50565b610f9a6108d0565b610fa357600080fd5b610fac81611075565b50565b6001818051602081018201805184825260208301602085012081835280955050505050506000915090508054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561106d5780601f106110425761010080835404028352916020019161106d565b820191906000526020600020905b81548152906001019060200180831161105057829003601f168201915b505050505081565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614156110af57600080fd5b8073ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b828054600181600116156101000203166002900490600052602060002090601f0160209004810192826111a257600085556111e9565b82601f106111bb57805160ff19168380011785556111e9565b828001600101855582156111e9579182015b828111156111e85782518255916020019190600101906111cd565b5b5090506111f691906111fa565b5090565b5b808211156112135760008160009055506001016111fb565b509056fea26469706673582212207e4f576259738773e4477d336e2e120142f2bdc76c0986c2f497d8eb87e0eb5f64736f6c6375302e372e352b636f6d6d69742e656237376564303800456231646661633730353234363763636637396637383730663261613361353134656666636262306461376535393831393435623338363531326465316664396464373062616538343062313361616334613630383362353835323238383235653762653165306561313434373436353938653432636133343032373963383033396532643133633036366633336666333062623937633233313335306332633364343136396664396437336431666431616366326436353064646562613737383532656438666262386631313737616337313764346362336565636664333833313762393339636539386138353866316463306535646162636166396265393633366236613234656337346436646335333234393661616138336232643966373139316165646235393530373361393962616135353234303933633736323966346233396361323065366331613137663839346531386535653434666137656134613731373762623430333863326263626261623431336537333334393462626165343161653730656330353937393162326535303866333936303538623965366132633538313431376637613466353933333234363066303861323536356564303537313832613165333461336563653761623936323262313331343732313034633466626564333063363732303132353731383437626261323831623235636136373861656163636130636161646632343732386437643338323164343166663733366461303761643166313365313835643362383739366461343532363538356366383637323330633461356664616462663331653734376234376231316238346537363263333265313232653030393761383432313134316565656363306534666362656165373333643965626632333964323866323262333163663964313039363462636461303835623237613233353061613530636634306234316563623434313734396632663339643036336636633763366632383061383038623764633230383763313266636533656562393637303761626330633261396336303838386330323033653561326661303031623462626238316361366165356533326337303031323534383462346538663230653539613365623563653265636664616531383764353436613934643237663235376635646461336164343735613334343339626664633136323430363662626130303731653733383130363433346664623034346535336161323732386637666366393837383137383430613332383933373734623062623465633033636664616430636131316265323064343863383431306435613363343863623366303761346566616261626163336131383637353564366162633730373030613363366238386538323366626339373335363131376137396332376535346238386132333763613661316364336533356564343233646434616263623139353732373437323334363138333130353936306165323832383038316432373663653131623838333961373232623961303132393930653638616361323038356466613463613230333732643662313166346435306133643461633339373736633337316361393564383836343662363566616635373363643837633036633039613131663333303939366239663562343430313463333639303239613031313832616130303634616335396531343932623666326230306639653038303532333464306661323737326138396431626534396130393561363837313534363561333762613566393162613633636262333731393438383864373732343230373830316134633463316432613135646662353061323339633666323739653837633366336164386466373864626337303439313066646563663234636435336236313865626361336535303034636265346431653264656239396434623332663835383363656635316634323839333737636135323637663462303032653863326439386338313135613465633934343739393033326164613962363333623664333130343364636436613761383461336437653631346638363164646364356131323834633833333138613561316663356534666262633733366661323534366237626533633966666565313930653339363064303035343161336237616462623933643237666634656136336337363036396636666161393031633761643162353266653433613836616664353462643838366637363261666130343539626334373065646538643964653064346537373466376436313739323435646332326366323739323638373631323930383931663831636461373238363833323733623139356436363463333738303331613934623434333034666464373763613331383732613736353664396339633861376232393631313762633336333634616336353361336666633866363138643734633537653663323733363036306236363763373162666130626565633836663133623839653239353032663533373130316465366166336463316139653165333164313439306464643733393530396436633565643766616563666564313339323636356633313239333963336630333134373030633266323265333864353464336635376334323331303162666661376238303766386339653065323631396538656366363364316166616532326165363236393132366138613961633362366563626438313736663830363566323735363838613535393865306463386237376135333431383733633530323463326431633066336536323864643539313166366534376638346462336236346333363438656262356131323761316263306630393337343839633830366331393434666430323964633937313539303738316466313134656330373265363431636463356432323435313334646333393636633865393134303236363961343763633835393730613238316632363861343462323161346637376139316135326639363036613330633966323264326535636236393334323633643038333838303931633536616331646662663162656561333165386136313363326135316635353064363935613531346433386234356338363233323061303065613533393431396134333364366266646431393738333536636263613462363030613537306665353832393138633466373331613030303230363864663238623261313933303839653662663935316335353362356136663731616161646363363636396466613334366633323237313738353161386332326133323430343161663837333665383764653433353838363066666630353762656666336631393034366134336164636534366339333235313439383861666531333039663837343134626433366564323936646163666164653265306361663033323335653931613264623237653965643231346263633665356366393935623565663539636539393433643166343230396236616262643663613462366232306266303333626666393431616633316262666237306637376635653838323936656365653938313563336363626439356433626130303033323638336366613238633433363566646365633536663533316632386365656531623732636363303061663437353535346163386366613636653461313764613465346265653562313133393061663436376438303634613962626263366239643933396165376366626661343838356464393739336630633533653936623966393332396235613837356262313236346634346466333364313136333963373966363337373334396339353739343463386466363631313937363633613232393362306533666130336262643063356634623236626438653065346466333537356633346462636665633739643637613333306362306163383833326235653962373133613132303162383436303765626232343337626466313038313764373861303762633633333635333365373738396666643235626333303564336461643838376462323965313962316135386232323065393364663864633963653536656461656331393131383230633966343933653963353135393938613662373366393461376630363532623334666162303230616230363238356266633138623761353938383430343165313438626662656262386265353130396366623035323065346164373863346164623064656235653630353136326236343639333439666331666465393236396238386435393665643966333733356330306335393233313763393832333230383734623938376263633338653835353661633534346264656531363962363661653866653633393832386666356166623466313939303137653364386536373561303737663231636439653563353236633138363634373665376261373463643762623136613163336439336263376262316435373661656462343330376336623934386435623863323966373933303737383864376138656266383435383562663533393934383237633233613561626332373135343133306231643934363364353662633833313231633061353136333730656236383466633438383538393165383833303039343361626431383039656235373264326430643063383133343364343666336564356663623934373062326334336430653037636437626261633839623063356136643637643663343964346234613661336630663331316433383733383933353038386666653763336233316439383662626534376438343462633137383634353030323639663538653433623865386132333066653964613531616639386634396564666530313530666535663236393736373862633931393336346131353430613761316362343035353463383738643230643365636139633462316138386430663661643562303362663238616332353430303766383463393137653631643230373037633935343730316432376461303366316339666433363332326539666631303732643232333038343263353739386232363536383937386430303562356331396530663636393131396231646134626233336136393331346666616139333837663662396334373164663537333230623136656565373430383335356635336537373832363432303333343131343338393566386332323936383331353732316664373536633661313264336361303130353038623233643738313764336139663439613532656334333931333633633038396564356338323335656536323665633238366665383439613135393837616636383736316366613532313362343138383231663335653634316464363032653039366631356530373066643236333539333938646431643535393361373534306431663064343232326665633431663566343464353835346237653933616262306233336334666434323366663866633536383466636366396566303031616638383162343163616465623363373965663563383034333066313433613563393338336262353062333439333731316634643337333966373236383735326265633433316232613866353961363634303831393663646636386266356337626535363131646361643334663332626461663139666331663766346633656566663362383333623938616638626166316163636336343663666336616133643362636330313734373164393662353862646466356233653338393764396662363137323035306663383664613535323436313232633463623937336561303237643639666166386530653635366366663664316632626164373064343264326565646633386363643862323033613339613964386161313333646334303161373231646633316235363663633231396562396565353532353662653336613864306135663531383439633339393939643964306361643337303565356234613234336162343062393435373831386431663237663262323130316530333032313230316266393462343039336438336532653965323138633362623132656531636164313030656630346432623534646462623432633665316231333864613138663738306465613132636637636461393033353536656263313936396234396335616530323632653834616464323061666265356364313166393038376438666431383130383166323136396437353031623237303139623236383430393265656636326230633863376338303933653339393566393139353136666535356537666130316462626461356265323363363036346531393037616531343764326139366338303839633735316565356131643837326235613762653131383435303536643238333834636662353939373863346139316234666665393064336465633036313662333932363033386632376461346534643235346338633132383362633964636461626561633530306662663065383962393864313035396137616138333238393362303863396535316663656134373661363935313162653631313235306139316236613132303461323235363162623837623739663139383561363837383531313834353333643933646661623938366663326330323833306337623132646639636630653332353965303638623937346533663663663939666136333734346338623562323336323961346566616434323566613262323962333632323434333337336434633338393338396563656363353639326530663135623534623966343962393939666430373534646234316134666331366238323336663638353535663935343633313133323665353663316561316665383538653363363666336131323832643434306533623438373537396464326331393863386231356135626162383266313531366634386334303133303633333139633461303637383966393433633566633465373736386332633064346365383731633363353161313737626138356165376530366436633339663063373333353036366363626635656661343561633564363436333863393130396137663065333839666337316138343361373561393532333136383862366133663038333163316332643563623962323731646130636532303066343037353466623435363161636232326330653161633839353132333634643734666565613966303732383934663261383866303834653039343835616539633566393631333038323935653162623765383335623837633362633062636530623832376638363030613131653937633534323931623030613037626138313762333365626661366363363766356635316265626532353837393031393738353166383039343361336263313735373234323861613139653461613934393039316639613433366161366530623365313737336539636132303134343166303761313034636365303335323863336431353839316139636530336564326138626134306463343265323934633364313830626135656534343838633834373232636561616462363934323864326336303236636634376135393261343637636338623135613733656133373533643766363135653531386261363134333930653663333739366561333733363763346631613130393634366435343732653965323865386434396538343932346536343830383765646535393664323236636232303936326630383133663066373731393262666661353262356566383636386134656565323935636534343665633866363833656462623761643233373330323366663332363764343463316261373932333831663638646265653364313734333164623365313166353231353133663132363434346130636331333463623730326264363933663761303030626539663063366235376632623637656132343632646530656638356339393239623933376264356635386536363838326238326239643233653038363438333138363032633864653439396539623132383762363638326133663264643365323265326635")
	createResult, contractAddress, createLeftGas, createErr := mockCreate(contractCodeBytes, config)
	fmt.Printf("New create contract address:%s\n", contractAddress.GetHexString())
	fmt.Printf("New create contract createResult:%v\n", createResult)
	fmt.Printf("New create contract createLeftGas:%v,createErr:%v\n", createLeftGas, createErr)

	root, err := config.State.Commit(true)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	trieDB := config.AccountDatabase.TrieDB()
	err = trieDB.Commit(root, false)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	db, err := account.NewAccountDB(root, config.AccountDatabase)
	if err != nil {
		t.Errorf("State commit error:%s", err.Error())
	}

	asString, err := dkim.ReadFileAsString("../utility/dkim/special_ch.eml", "")
	if nil != err {
		fmt.Println(err)
		return
	}

	res := dkim.Verify(utility.StrToBytes(asString), contractAddress, db)
	fmt.Println(common.ToHex(res))
	fmt.Println(len(res))
}

